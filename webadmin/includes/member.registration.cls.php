<?php
include_once("_framework/_nemo.list.cls.php");

## GLOBAL TRANSLATIIONS
## ADDITIONAL TRANSLATIONS
$_TRANSLATION["EN"]["WizzardName"] = "SAWIS Member Registration";
$_TRANSLATION["AF"]["WizzardName"] = "SAWIS Lid Registrasie";

## LANDING PAGE
$_TRANSLATION["EN"]["LP_Heading"] = "SAWIS User Registration";
$_TRANSLATION["AF"]["LP_Heading"] = "SAWIS Gebruiker Registrasie";
$_TRANSLATION["EN"]["LP_Intro"] = "Welcome to the SAWIS User Registration Site";
$_TRANSLATION["AF"]["LP_Intro"] = "Welkom by SAWIS Gebruiker Registrastie webtuiste";
$_TRANSLATION["EN"]["Content"] = "In order to complete your registration as quickly as possible you will require the following:";
$_TRANSLATION["AF"]["Content"] = "Om die registrasie so spoedig moontlik af te handel word die volgende benodig:";
$_TRANSLATION["EN"]["listItem1"] = "Business Registration and Legal Documents";
$_TRANSLATION["AF"]["listItem1"] = "Besigheid registrasie en Dokumente";
$_TRANSLATION["EN"]["listItem2"] = "Owner Information";
$_TRANSLATION["AF"]["listItem2"] = "Eienaar Informasie";
$_TRANSLATION["EN"]["listItem3"] = "etc.";
$_TRANSLATION["AF"]["listItem3"] = "Ensovoorts";
$_TRANSLATION["EN"]["Question"] = "Do you have a SAWIS Member Number?";
$_TRANSLATION["AF"]["Question"] = "Het u 'n SAWIS lidnommer?";
$_TRANSLATION["EN"]["DraftError"] = "No pending registrations found.";
$_TRANSLATION["AF"]["DraftError"] = "Geen Hangende registrasies gevind. ";
$_TRANSLATION["EN"]["DraftMessage"] = "There is a pending draft for this account.";
$_TRANSLATION["AF"]["DraftMessage"] = "Daar is a hangende registrasie vir die rekening";
$_TRANSLATION["EN"]["chkOptionY"] = "Continue with previous registration ";
$_TRANSLATION["AF"]["chkOptionY"] = "Gaan voort met vorige registrasie ";

## STEP 1 :: USER DETAILS
$_TRANSLATION["EN"]["UD_Heading"] = "User Details";
$_TRANSLATION["AF"]["UD_Heading"] = "Gebruiker Besonderhede";
$_TRANSLATION["EN"]["UD_Intro"] = "Step 1 is setting up your User Details. <br> <br> By completing this application you will be regarded as the primary contact / SuperUser of this Member.";
$_TRANSLATION["AF"]["UD_Intro"] = "Stap 1 is om jou gebruikers besonderhede op te stel. <br> <br> Deur die aansoek te voltooi, word u as die primêre kontakpersoon beskou / Super gebruiker van die Lid.";

$_TRANSLATION["EN"]["strTitle"] = "Title";
$_TRANSLATION["AF"]["strTitle"] = "Titel";
$_TRANSLATION["EN"]["strName"] = "Name";
$_TRANSLATION["AF"]["strName"] = "Naam";
$_TRANSLATION["EN"]["strSurname"] = "Surname";
$_TRANSLATION["AF"]["strSurname"] = "Van";
$_TRANSLATION["EN"]["strTel"] = "Tel";
$_TRANSLATION["AF"]["strTel"] = "Tel";
$_TRANSLATION["EN"]["strAreaCode"] = "Area Code";
$_TRANSLATION["AF"]["strAreaCode"] = "Area Kode";
$_TRANSLATION["EN"]["strCell"] = "Cell";
$_TRANSLATION["AF"]["strCell"] = "Sel";
$_TRANSLATION["EN"]["strFax"] = "Fax";
$_TRANSLATION["AF"]["strFax"] = "Faks";
$_TRANSLATION["EN"]["strPasswordConfirm"] = "Password Confirm";
$_TRANSLATION["AF"]["strPasswordConfirm"] = "Bevestig Wagwoord";
$_TRANSLATION["EN"]["strLanguage"] = "Language";
$_TRANSLATION["AF"]["strLanguage"] = "Taal";

$_TRANSLATION["EN"]["valid_strTitle"] = "Please insert your title.";
$_TRANSLATION["AF"]["valid_strTitle"] = "Voeg asseblief u titel by.";
$_TRANSLATION["EN"]["valid_strName"] = "Please insert your name.";
$_TRANSLATION["AF"]["valid_strName"] = "Voeg asseblief u naam in.";
$_TRANSLATION["EN"]["valid_strSurname"] = "Please insert your surname.";
$_TRANSLATION["AF"]["valid_strSurname"] = "Voeg asseblief u van in.";
$_TRANSLATION["EN"]["valid_strTel"] = "Please insert a valid telephone number.";
$_TRANSLATION["AF"]["valid_strTel"] = "Voeg asseblief 'n geldige telefoonnommer in.";
$_TRANSLATION["EN"]["valid_strTel_Invalid"] = "Invalid telephone number.";
$_TRANSLATION["AF"]["valid_strTel_Invalid"] = "Ongeldige telefoonnommer.";
$_TRANSLATION["EN"]["valid_strTel_Area"] = "Invalid area code.";
$_TRANSLATION["AF"]["valid_strTel_Area"] = "Ongeldige area kode.";
$_TRANSLATION["EN"]["valid_strCell"] = "Invalid Cellphone number.";
$_TRANSLATION["AF"]["valid_strCell"] = "Ongeldige selfoonnommer.";
$_TRANSLATION["EN"]["valid_strFax"] = "Invalid Fax number.";
$_TRANSLATION["AF"]["valid_strFax"] = "Ongeldige faksnommer.";
$_TRANSLATION["EN"]["valid_strEmail"] = "Please insert a valid Email.";
$_TRANSLATION["AF"]["valid_strEmail"] = "Voeg asseblief 'n geldige epos adres in.";
$_TRANSLATION["EN"]["valid_strEmail_Invalid"] = "Invalid Email.";
$_TRANSLATION["AF"]["valid_strEmail_Invalid"] = "ongeldige epos.";
$_TRANSLATION["EN"]["valid_strEmail_exist"] = "Email already in use.";
$_TRANSLATION["AF"]["valid_strEmail_exist"] = "Epos adres in gebruik.";
$_TRANSLATION["EN"]["valid_strLanguage"] = "Please select your prefered language. ";
$_TRANSLATION["AF"]["valid_strLanguage"] = "Asseblief kies u voorkeur taal. ";
$_TRANSLATION["EN"]["valid_strPassword"] = "Please insert Password.";
$_TRANSLATION["AF"]["valid_strPassword"] = "Voeg asseblief u wagwoord in.";
$_TRANSLATION["EN"]["valid_strPassword_strong"] = "Password is not strong enough.";
$_TRANSLATION["AF"]["valid_strPassword_strong"] = "Wagwoord is nie sterk genoeg nie.";
$_TRANSLATION["EN"]["valid_strPasswordConfirm"] = "Password confirmation does not match.";
$_TRANSLATION["AF"]["valid_strPasswordConfirm"] = "Wagwoorde verskil.";
$_TRANSLATION["EN"]["isCaseSensitive"] = "Password is case sensitive.";
$_TRANSLATION["AF"]["isCaseSensitive"] = "Wagwoord is kassensitief.";


## STEP 2 :: USER TYPE
$_TRANSLATION["EN"]["UT_Heading"] = "Member Type";
$_TRANSLATION["AF"]["UT_Heading"] = "Lid Tipe";
$_TRANSLATION["EN"]["UT_Intro"] = "In order to complete your registration as quickly as possible you will require the following:$BR*Business Registration and Legal$BR Documents";
$_TRANSLATION["AF"]["UT_Intro"] = "Om die registrasie so gou as moontlik af te handel u die volgende nodig:$BR *Besigheid registrasie en Dokumente$BR *Ensovoorts";

$_TRANSLATION["EN"]["UserType1"] = "I am a new member.";
$_TRANSLATION["AF"]["UserType1"] = "Ek is 'n nuwe lid.";
$_TRANSLATION["EN"]["UserType2"] = "I want to link to an existing member.";
$_TRANSLATION["AF"]["UserType2"] = "Ek wil skakel na 'n bestaande lid.";

## STEP 3 :: MEMBER TYPE & MEMBER SELECT
$_TRANSLATION["EN"]["MT_Heading"] = "Membership Type";
$_TRANSLATION["AF"]["MT_Heading"] = "Lidmaatskap Tipe";
$_TRANSLATION["EN"]["MT_Intro"] = "This is just test data$BR This is just test data$BR This is just test data";
$_TRANSLATION["AF"]["MT_Intro"] = "This is just test data$BR This is just test data$BR This is just test data";

$_TRANSLATION["EN"]["MS_Heading"] = "Select Member";
$_TRANSLATION["AF"]["MS_Heading"] = "Kies Lidmaatskap";
$_TRANSLATION["EN"]["MS_Intro"] = "This is just test data$BR This is just test data$BR This is just test data";
$_TRANSLATION["AF"]["MS_Intro"] = "This is just test data$BR This is just test data$BR This is just test data";

$_TRANSLATION["EN"]["MemberID"] = "Insert the Producer Code you would like to link.";
$_TRANSLATION["AF"]["MemberID"] = "Verskaf die Produsent Kode wat u wil heg";
$_TRANSLATION["EN"]["MemberSearchPromp"] = "Member does not exist.";
$_TRANSLATION["AF"]["MemberSearchPromp"] = "Lid bestaan nie.";
$_TRANSLATION["EN"]["valid_link"] = "Member does not exist.";
$_TRANSLATION["AF"]["valid_link"] = "Lid bestaan nie.";
$_TRANSLATION["EN"]["checkBtn"] = "<input type='button' value='Check' onclick='jsGetMemberDetails();' class='controlButton' />";
$_TRANSLATION["AF"]["checkBtn"] = "<input type='button' value='Kontroleer' onclick='jsGetMemberDetails();' class='controlButton' />";

$_TRANSLATION["EN"]["TypeOfMembership"] = "Type of Membership";
$_TRANSLATION["AF"]["TypeOfMembership"] = "Lidmaatskap Tipe";
//A
$_TRANSLATION["EN"]["radOptionA1"] = "New Cellar ";
$_TRANSLATION["AF"]["radOptionA1"] = "Nuwe Kelder ";
$_TRANSLATION["EN"]["radOptionA2"] = "New Cellar Belonging to a Wholesaler ";
$_TRANSLATION["AF"]["radOptionA2"] = "Nuwe Kelder wat behoort aan 'n Groothandelaar ";
$_TRANSLATION["EN"]["PackhouseNumber"] = "Warehouse Number (SARS)  ";
$_TRANSLATION["AF"]["PackhouseNumber"] = "Pakhuisnommer(SARS)";
//B
$_TRANSLATION["EN"]["radOptionB"] = "For Certification purposes within a SAWIS registered cellar";
$_TRANSLATION["AF"]["radOptionB"] = "Vir Sertifiseringsdoeleindes binne 'n bestaande SAWIS geregistreerde kelder*";
$_TRANSLATION["EN"]["lblSearchPromp"] = "Indicate Producer Code: ";
$_TRANSLATION["AF"]["lblSearchPromp"] = "Verskaf Produsent Kode: ";
$_TRANSLATION["EN"]["lblSearchPlaceholder"] = "Search Member Number";
$_TRANSLATION["AF"]["lblSearchPlaceholder"] = "Soek Ledenummer";
//C
$_TRANSLATION["EN"]["radOptionC"] = "Exporter Only ";
$_TRANSLATION["AF"]["radOptionC"] = "Slegs Uitvoerder ";
$_TRANSLATION["EN"]["lblBottledStock"] = "Do you only buy bottled stock to export?";
$_TRANSLATION["AF"]["lblBottledStock"] = "Koop u slegs gebotteleerde voorraad vir uitvoere?";
//D
$_TRANSLATION["EN"]["chkOptionD"] = "Grape Producer Only";
$_TRANSLATION["AF"]["chkOptionD"] = "Slegs Druiwe Produsent";

## VALIDATION
$_TRANSLATION["EN"]["valid_refMembershipType"] = "Please indicate which member facility will be used.";
$_TRANSLATION["AF"]["valid_refMembershipType"] = "Dui aan watter Lid fasiliteit gebruik gaan word.";
$_TRANSLATION["EN"]["valid_Warehouse"] = "Invalid Warehouse Number.";
$_TRANSLATION["AF"]["valid_Warehouse"] = "Invalid Warehouse Number.";
$_TRANSLATION["EN"]["valid_A1"] = "Please select a Cellar type.";
$_TRANSLATION["AF"]["valid_A1"] = "Asseblief kies 'n kelder tiepe.";
$_TRANSLATION["EN"]["valid_A2"] = "Please select a Wholesaler type.";
$_TRANSLATION["AF"]["valid_A2"] = "Kies asseblief 'n Handelaar tipe.";
$_TRANSLATION["EN"]["valid_B"] = "Please indicate which member facility will be used.";
$_TRANSLATION["AF"]["valid_B"] = "Dui aan watter SAWIS lid se fasiliteite u sal gebruik.";
$_TRANSLATION["EN"]["valid_C"] = "Do you only buy and export bottled stock?";
$_TRANSLATION["AF"]["valid_C"] = "Koop en voer u slegs gebottelde voorraad uit?";

## STEP 4 :: MEMBER DETAILS
$_TRANSLATION["EN"]["MD_Heading"] = "Member Details";
$_TRANSLATION["AF"]["MD_Heading"] = "Lid Besonderhede";
$_TRANSLATION["EN"]["MD_Intro"] = "This is just test data$BR This is just test data$BR This is just test data";
$_TRANSLATION["AF"]["MD_Intro"] = "This is just test data$BR This is just test data$BR This is just test data";

$_TRANSLATION["EN"]["strMember"] = "Registered Business Name";
$_TRANSLATION["AF"]["strMember"] = "Geregistreerde Besigheidsnaam";
$_TRANSLATION["EN"]["strLegalEntityType"] = "Legal Entity Type";
$_TRANSLATION["AF"]["strLegalEntityType"] = "Regspersoon Tipe";
$_TRANSLATION["EN"]["strRegistrationNumber"] = "Business Registration Number";
$_TRANSLATION["AF"]["strRegistrationNumber"] = "Besigheids Registrasie Nommer";
$_TRANSLATION["EN"]["strVATRegistrationNumber?"] = "Do you require a tax invoice?";
$_TRANSLATION["AF"]["strVATRegistrationNumber?"] = "Benodig u 'n belastingfaktuur?";
$_TRANSLATION["EN"]["strVATRegistrationNumber"] = "VAT Registration Number?";
$_TRANSLATION["AF"]["strVATRegistrationNumber"] = "BTW Registrasie Nommer";
$_TRANSLATION["EN"]["txtPostalAddress"] = "Postal Address";
$_TRANSLATION["AF"]["txtPostalAddress"] = "Posadres";
$_TRANSLATION["EN"]["txtPhysicalAddress"] = "Physical Address";
$_TRANSLATION["AF"]["txtPhysicalAddress"] = "Fisiese Adres";
$_TRANSLATION["EN"]["strWebsiteURL"] = "Web site";
$_TRANSLATION["AF"]["strWebsiteURL"] = "Webtuiste";
$_TRANSLATION["EN"]["btnCopyPostal"] = "Copy Postal Address";
$_TRANSLATION["AF"]["btnCopyPostal"] = "Kopiër Pos Adres";

$_TRANSLATION["EN"]["valid_strMember"] = "Please insert Registered Business Name.";
$_TRANSLATION["AF"]["valid_strMember"] = "Sleutel asseblief Geregistreerde Besigheidsnaam in.";
$_TRANSLATION["EN"]["valid_strMember_exist"] = "Registered Business Name already exists.";
$_TRANSLATION["AF"]["valid_strMember_exist"] = "AF: Registered Business Name already exists.";
$_TRANSLATION["EN"]["valid_strLegalEntityType"] = "Please select a legal entity type.";
$_TRANSLATION["AF"]["valid_strLegalEntityType"] = "Kies asseblief 'n regsentiteit tipe.";
$_TRANSLATION["EN"]["valid_strRegistrationNumber"] = "Please insert your Registration Number.";
$_TRANSLATION["AF"]["valid_strRegistrationNumber"] = "Verskaf asseblief die Registrasie nommer.";
$_TRANSLATION["EN"]["valid_strRegistrationNumber_exist"] = "Registration Number already exists.";
$_TRANSLATION["AF"]["valid_strRegistrationNumber_exist"] = "AF: Registration Number already exists.";
$_TRANSLATION["EN"]["valid_strVATRegistrationNumber_exist"] = "VAT Registration Number already exists.";
$_TRANSLATION["AF"]["valid_strVATRegistrationNumber_exist"] = "AF: VAT Registration Number already exists.";
$_TRANSLATION["EN"]["valid_strVATRegistrationNumber"] = "Please insert your VAT Registration Number.";
$_TRANSLATION["AF"]["valid_strVATRegistrationNumber"] = "AF: Please insert your VAT Registration Number.";
$_TRANSLATION["EN"]["valid_radVatNumber"] = "Please choose if you require a tax invoice.";
$_TRANSLATION["AF"]["valid_radVatNumber"] = "Kies asseblief of u n belastingfakture benodig.";
$_TRANSLATION["EN"]["valid_txtPostalAddress"] = "Please insert your Postal Address.";
$_TRANSLATION["AF"]["valid_txtPostalAddress"] = "Sleutel asseblief u posadres is.";
$_TRANSLATION["EN"]["valid_txtPhysicalAddress"] = "Please insert your Physical Address.";
$_TRANSLATION["AF"]["valid_txtPhysicalAddress"] = "Sleutel asseblief u fisiese adres is.";
$_TRANSLATION["EN"]["Correspondence"] = "Correspondence language";
$_TRANSLATION["AF"]["Correspondence"] = "Korrespondensie taal";

## STEP 5 :: DOCUMENTS
$_TRANSLATION["EN"]["D_Heading"] = "Documents";
$_TRANSLATION["AF"]["D_Heading"] = "Dokumente";
$_TRANSLATION["EN"]["D_Intro"] = "This is just test data$BR This is just test data$BR This is just test data";
$_TRANSLATION["AF"]["D_Intro"] = "This is just test data$BR This is just test data$BR This is just test data";
$_TRANSLATION["EN"]["btnAdd"] = "Add";
$_TRANSLATION["AF"]["btnAdd"] = "Voeg";
$_TRANSLATION["EN"]["TitleDocuments"] = "Document List";
$_TRANSLATION["AF"]["TitleDocuments"] = "Dokument Lys";
$_TRANSLATION["EN"]["arrType"] = "Type";
$_TRANSLATION["AF"]["arrType"] = "Tiepe";
$_TRANSLATION["EN"]["arrFileName"] = "Filename";
$_TRANSLATION["AF"]["arrFileName"] = "Dokument Naam";
$_TRANSLATION["EN"]["arrUploadDate"] = "Upload Date";
$_TRANSLATION["AF"]["arrUploadDate"] = "Oplaai Datum";
$_TRANSLATION["EN"]["optSelect"] = "- Select -";
$_TRANSLATION["AF"]["optSelect"] = "- Kies -";
$_TRANSLATION["AF"]["FileTypes"] = "<br> <b style='font-weight:bold'>Toegelate tipe Lêers :</b> PDF,PNG & JPG
												<br> <b style='font-weight:bold'>Maksimum grootte :</b> 5MB</td>";
$_TRANSLATION["EN"]["FileTypes"] = "<br> <b style='font-weight:bold'>Allowed File Types :</b> PDF,PNG & JPG
												<br> <b style='font-weight:bold'>Max File Size :</b> 5MB</td>";
$_TRANSLATION["EN"]["valid_strFileSize_Invalid"] = "Please choose another file,this file is bigger than 5MB.";
$_TRANSLATION["AF"]["valid_strFileSize_Invalid"] = "AF: Please choose another file,this file is bigger than 5MB.";
$_TRANSLATION["EN"]["valid_strFileType_Invalid"] = "Please choose another file,this file type is not accepted.";
$_TRANSLATION["AF"]["valid_strFileType_Invalid"] = "AF: Please choose another file,this file type is not accepted.";

## STEP 6 :: REVIEW
$_TRANSLATION["EN"]["R_Heading"] = "Review";
$_TRANSLATION["AF"]["R_Heading"] = "Hersien";
$_TRANSLATION["EN"]["R_Intro"] = "This is just test data$BR This is just test data$BR This is just test data";
$_TRANSLATION["AF"]["R_Intro"] = "This is just test data$BR This is just test data$BR This is just test data";

$_TRANSLATION["EN"]["F_Heading"] = "Farm Details";
$_TRANSLATION["AF"]["F_Heading"] = "Plaas Besonderhede";
$_TRANSLATION["EN"]["N_Heading"] = "User Notes / Comments / Suggestions";
$_TRANSLATION["AF"]["N_Heading"] = "Gebruikersnotas / Kommentaar / Voorstelle";

$_TRANSLATION["EN"]["MemberFacility"] = "Facilitation SAWIS Member";
$_TRANSLATION["AF"]["MemberFacility"] = "Fasiliteerende SAWIS Lid";

$_TRANSLATION["EN"]["TR_TH_DocumentList"] = "
	<tr>
		<td><u>Filename</u></td>
	</tr>";
$_TRANSLATION["AF"]["TR_TH_DocumentList"] = "
	<tr>
		<td style='padding-left:0px;'><u>Dokument Tipe</u></td>
		<td><u>Leêrnaam</u></td>
	</tr>";

$_TRANSLATION["EN"]["blnFarmNotice"] = "NOTE! Farm Registration Details will follow this submision as a separate process";
$_TRANSLATION["AF"]["blnFarmNotice"] = "NEEM KENNIS! Plaasregistrasiebesonderhede volg hierdie aansoek as 'n aparte proses.";

$_TRANSLATION["EN"]["T&C"] = "I have read and accept the <a href='". $SystemSettings["T&C_URL"] ."' target=_blank>Terms & Conditions.</a>";
$_TRANSLATION["AF"]["T&C"] = "Ek het die <a href='". $SystemSettings["T&C_URL"] ."' target=_blank>Terme en Voorwaardes</a> gelees en aanvaar.";

$_TRANSLATION["EN"]["valMT"] = "EN VALIDATION Membership Type incomplete. \\n";
$_TRANSLATION["AF"]["valMT"] = "AF VALIDATION Membership Type incomplete. \\n";
$_TRANSLATION["EN"]["valUD"] = "EN VALIDATION User Details incomplete. \\n";
$_TRANSLATION["AF"]["valUD"] = "AF VALIDATION User Details incomplete. \\n";
$_TRANSLATION["EN"]["valMD"] = "EN VALIDATION Member Details incomplete. \\n";
$_TRANSLATION["AF"]["valMD"] = "AF VALIDATION Member Details incomplete. \\n";
$_TRANSLATION["EN"]["valD"] = "EN VALIDATION Required Documents missing. \\n";
$_TRANSLATION["AF"]["valD"] = "AF VALIDATION Required Documents missing. \\n";
$_TRANSLATION["EN"]["valTC"] = "EN VALIDATION Terms and Conditions. \\n";
$_TRANSLATION["AF"]["valTC"] = "AF VALIDATION Terme en Voorwaardes. \\n";

## STEP 7 :: COMPLETED
$_TRANSLATION["EN"]["C_Heading"] = "Member Registration Completed";
$_TRANSLATION["AF"]["C_Heading"] = "Lidregistrasie is Voltooi";
$_TRANSLATION["EN"]["C_Intro"] = "Thank you for $BR This is just test data$BR This is just test data";
$_TRANSLATION["AF"]["C_Intro"] = "Dankie$BR This is just test data$BR This is just test data";

$_TRANSLATION["EN"]["ContinueSAWIS2"] = "To continue with Farm Registration please ";
$_TRANSLATION["AF"]["ContinueSAWIS2"] = "To continue with Farm Registration please ";
$_TRANSLATION["EN"]["btnContinueSawis2"] = "Click Here";
$_TRANSLATION["AF"]["btnContinueSawis2"] = "klik Hier";
$_TRANSLATION["EN"]["LoginSAWIS"] = "<a href='index.php'>Login to SAWIS</a>";
$_TRANSLATION["AF"]["LoginSAWIS"] = "<a href='index.php'>Tekan aan by SAWIS</a>";

## STEP 7 :: COMPLETED LINKED
$_TRANSLATION["EN"]["CL_Heading"] = "Member Linking Completed";
$_TRANSLATION["AF"]["CL_Heading"] = "Lid skakel is Voltooi";
$_TRANSLATION["EN"]["CL_Intro"] = "Thank you for $BR This is just test data$BR This is just test data";
$_TRANSLATION["AF"]["CL_Intro"] = "Dankie$BR This is just test data$BR This is just test data";

## WIZZARD GLOBAL
$_TRANSLATION["EN"]["strEmail"] = "Email";
$_TRANSLATION["AF"]["strEmail"] = "Epos";
$_TRANSLATION["EN"]["strPassword"] = "Password";
$_TRANSLATION["AF"]["strPassword"] = "Wagwoord";

$_TRANSLATION["EN"]["optSelect"] = "- Select -";
$_TRANSLATION["AF"]["optSelect"] = "- Kies -";

$_TRANSLATION["EN"]["optYes"] = "Yes";
$_TRANSLATION["AF"]["optYes"] = "Ja";
$_TRANSLATION["EN"]["optNo"] = "No";
$_TRANSLATION["AF"]["optNo"] = "Nee";

$_TRANSLATION["EN"]["btnCheck"] = "Check";
$_TRANSLATION["AF"]["btnCheck"] = "Kontroleer";
$_TRANSLATION["EN"]["btnNext"] = "Next";
$_TRANSLATION["AF"]["btnNext"] = "Volgende";
$_TRANSLATION["EN"]["btnPrevious"] = "Previous";
$_TRANSLATION["AF"]["btnPrevious"] = "Gaan terug";
$_TRANSLATION["EN"]["btnContinue"] = "Continue";
$_TRANSLATION["AF"]["btnContinue"] = "Gaan voort";
$_TRANSLATION["EN"]["btnLoadDraft"]= "Load Draft";
$_TRANSLATION["AF"]["btnLoadDraft"]= "Laai";
$_TRANSLATION["EN"]["btnSubmit"] = "Submit Application";
$_TRANSLATION["AF"]["btnSubmit"] = "Stuur Aansoek";
$_TRANSLATION["EN"]["btnClickHere"] = "Click Here";
$_TRANSLATION["AF"]["btnClickHere"] = "klik Hier";

class MemberRegistration extends NemoList
{
	private $ID = 0;
	public function __construct($DataKey)
	{
		parent::__construct($DataKey);
	}

## GET CONTENT FOR LANDING PAGE ########################################################################################################################################################
########################################################################################################################################################################################
########################################################################################################################################################################################

	function getLandingPageContent()
	{
		## GLOBAL VARS
		global $xdb, $arrSys, $TR, $SP, $BR, $HR, $DATABASE_SETTINGS, $SystemSettings, $imgRequired, $_TRANSLATION;

		## HTML CONTENT
		$Content =  $_TRANSLATION[$_SESSION[LANGUAGE]]["Content"].
						"<ul>
							<li>".$_TRANSLATION[$_SESSION[LANGUAGE]]["listItem1"]."</li>
							<li>".$_TRANSLATION[$_SESSION[LANGUAGE]]["listItem3"]."</li>
						</ul>

						<div style='border-bottom:1px groove #333;'></div>
						$BR
						<table width='100%'>
							<tr>
								<td >
									<input id='OptionY' type='checkbox' name='refMembershipType' value='Y' onclick=' jsOpenLogin();' /> <label for='OptionY'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["chkOptionY"]."</label>
									<label id='lbl_OptionY' class='RequiredFieldIndicatorChanger'></label>
								</td>
								<td align='right'> </td>
								<td align='right' width='50px'>
									<div class='Tooltip'><div id='FaqIDx_8' class='Tooltip_Icon' onClick='jsHoverTooltip(8);'><img width='25px' height='25px' src='images/info-icon.png' /></div></div>
								</td>
							</tr>
						</table>
						<div id='FaqContent_8' class='Tooltip_Text'>".MemberRegistration::GetTooltip(8)."</div>
						<div id='ErrorContent_Y' class='Error_Text'></div>
						<div id='loginBox' style='display:none;'>
							<table style='' width='100%'>
								<tr>
									<td valign='top' $ColumWidthLabel >".$_TRANSLATION[$_SESSION[LANGUAGE]]["strEmail"].":</td>
									<td valign='top' $ColumWidthInput><input id='strEmail' class='controlText' type='text' value='$strEmail' name='strEmail' > $imgRequired</td>
									<td valign='top' $ColumWidthIcon> </td>
									<td valign='top' $ColumWidthComment> </td>
								</tr>
								<tr>
									<td valign='top' $ColumWidthLabel>".$_TRANSLATION[$_SESSION[LANGUAGE]]["strPassword"].":</td>
									<td valign='top' $ColumWidthInput><input id='strPassword' class='controlText' type='password' value='' name='strPassword' > $imgRequired</td>
									<td valign='top' $ColumWidthIcon> </td>
									<td valign='top' $ColumWidthComment > </td>
								</tr>
								<tr>
									<td valign='top' $ColumWidthLabel></td>
									<td valign='top' $ColumWidthInput><input onclick='jsCheckRegProcessInProgress();' id='btnCheck' class='controlButton' type='button' value='".$_TRANSLATION[$_SESSION[LANGUAGE]]["btnCheck"]."' ></td>
									<td valign='top' $ColumWidthIcon> </td>
									<td valign='top' $ColumWidthComment > </td>
								</tr>
							</table>
						</div>
						<input type='hidden' id='MemberID' name='MemberID' value='$MemberID' />
						<input type='hidden' id='UserID' name='UserID' value='$UserID' />
						<input type='hidden' id='RegistrationStatus' name='RegistrationStatus' value='$RegistrationStatus' />
						<input type='hidden' id='IsActive' name='IsActive' value='$IsActive' />
						<div align='center' id='msgError' >".$_TRANSLATION[$_SESSION[LANGUAGE]]["DraftError"]."</div>
						<div align='center' id='msgPendingDraft' > </div> ";

		$JS = "  <script>

						// SHOW AND HIDE THE LOGIN SECTION //////////////////////////////////////////////////////
						function jsOpenLogin()
						{
							Checking = $('#OptionY').is(':checked');

							if(Checking == true)
							{
								$('#loginBox').slideDown(300)
								$('#FaqContent_8').slideDown('fast');
							}
							else
							{
								$('#FaqContent_8').slideUp('fast');
								$('#loginBox').slideUp(300)
							}
						}

						// CHECK IF LOGIN EXIST //////////////////////////////////////////////////////////////////
						function jsCheckRegProcessInProgress()
						{
							Email = $('#strEmail').val();
							Password = $('#strPassword').val();

							$.ajax(
							{
								type: 'POST',
								dataType: 'json', 
								url: 'ajaxfunctions.php',
								data: 'header=text&type=RegInProcess&strEmail=' + Email + '&strPassword=' + Password,
								success: function(data)
								{
									if(data.UserID)
									{
										console.log('returned',data);
										$('#msgPendingDraft').html(' ".$_TRANSLATION[$_SESSION[LANGUAGE]]["DraftMessage"]."<input class=\"controlButtonMSG\" type=\"submit\" value=\"".$_TRANSLATION[$_SESSION[LANGUAGE]]["btnLoadDraft"]."\" name=\"Action\"</a> ');
										$('#MemberID').val(data.MemberID);
										$('#UserID').val(data.UserID);
										$('#IsActive').val(data.IsActive);
										$('#RegistrationStatus').val(data.RegistrationStatus);
										$('#msgError').slideUp('fast');
										$('#msgPendingDraft').slideDown('fast').delay( 800 );
									}
									else
									{
										$('#msgPendingDraft').slideUp('fast');
										$('#msgError').slideDown('fast').delay( 800 );
									}
								}
							});
						}
					</script>";

		## RETURN
		return $Content . $JS;
	}

	## GET THE USER DETAILS CONTENT ########################################################################################################################################################
	########################################################################################################################################################################################
	########################################################################################################################################################################################

	function getUserDetailsContent()
	{
		## GLOBAL VARS
		global $xdb, $arrSys, $BR, $TR, $SP, $HR, $DATABASE_SETTINGS, $SystemSettings, $imgRequired, $_LANGUAGE, $_TRANSLATION ;

		## INI

		## COLUMN WIDTH
		$ColumWidthLabel = "width= '20%'";
		$ColumWidthInput = "width= '35%'";
		$ColumWidthIcon = "width= '5%'";
		$ColumWidthComment = "width= '40%'";

		## LOAD

		## IF MEMBER EXIST GET DETAILS AND FILL FORM
		if($_SESSION[S3REGISTRATION]->UserID != "")
		{
			## GET MEMBER AND USER DETAILS
			$UserID = $_SESSION[S3REGISTRATION]->UserID;
			$row = $xdb->getRowSQL("SELECT sysUser.* FROM sysUser WHERE UserID = '".$_SESSION[S3REGISTRATION]->UserID ."'",0);

			## UPDATE VARS
			$strTitle = $row->strTitle;
			$strName = $row->strName;
			$strSurname = $row->strSurname;
			$strAreaCode = $row->strAreaCode;
			$strTel = $row->strTel;
			$strCell = $row->strCell;
			$strFax = $row->strFax;
			$strEmail = $row->strEmail;
			$strLanguage = "strSetting:Language"; $strLanguage = $row->$strLanguage;
			$readonly = "readonly='readonly'";
		}
		else
		{}

		## GET AVAILABLE LANGUAGE LIST
		$ddlLanguage = "";
		foreach($_LANGUAGE AS $key => $arrLanguageDetails)
		{
			$ddlLanguage .= "<option ". ($strLanguage == $arrLanguageDetails->strLanguage ? "selected" : "").">$arrLanguageDetails->strLanguage</option>";
		}

	## STRIPPING THE TELEPHONE NUMBER OF THE AREA CODE
	$telNo =  explode("-", $strTel);
	$strAreaCode = $telNo[0];
	$strTel = $telNo[1];

		## HTML CONTENT
		$Content = "
			<div>
				<table width='100%'>
					<tr>
						<td><label for='OptionA1'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["strTitle"].":</label>$imgRequired</td>
						<td align='right'><input id='strTitle' class='controlText' type='text' value=\"$strTitle\" name='strTitle' />  </td>
						<td align='right' width='50px'></td>
					</tr>
				</table>
				<div id='ErrorContent_strTitle' class='Error_Text'></div>
				<table width='100%'>
					<tr>
						<td><label for='OptionA1'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["strName"].":</label>$imgRequired</td>
						<td align='right'><input id='strName' class='controlText' type='text' value=\"$strName\" name='strName' />  </td>
						<td align='right' width='50px'></td>
					</tr>
				</table>
				<div id='FaqContent_3' class='Tooltip_Text'></div>
				<div id='ErrorContent_strName' class='Error_Text'></div>
				<table width='100%'>
					<tr>
						<td><label for='OptionA1'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["strSurname"].":</label>$imgRequired</td>
						<td align='right'><input id='strSurname' class='controlText' type='text' value=\"$strSurname\" name='strSurname' ></td>
						<td align='right' width='50px'></td>
					</tr>
				</table>
				<div id='ErrorContent_strSurname' class='Error_Text'></div>

				<table width='100%'>
					<tr>
						<td><label for='OptionA1'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["strTel"].":</label>$imgRequired</td>
						<td align='right'>
							<input onchange='jsAreaCodeValid();' style='width:50px;' id='strAreaCode' class='controlText' type='text' value=\"$strAreaCode\" name='strAreaCode' > -
							<input onchange='jsTelValid();' style='width:171px;' id='strTel' class='controlText' type='text' value=\"$strTel\" name='strTel' >
						</td>
						<td align='right' width='50px'></td>
					</tr>
				</table>
				<div id='ErrorContent_strTel' class='Error_Text'></div>
				<div id='ErrorContent_strArea' class='Error_Text'></div>
				<table width='100%'>
					<tr>
						<td><label for='OptionA1'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["strCell"].":</label> </td>
						<td align='right'><input onchange='jsCellValid();' id='strCell' class='controlText' type='text' value=\"$strCell\" name='strCell' ></td>
						<td align='right' width='50px'></td>
					</tr>
				</table>
				<div id='ErrorContent_strCell' class='Error_Text'></div>
				<table width='100%'>
					<tr>
						<td><label for='OptionA1'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["strFax"].":</label></td>
						<td align='right'><input onchange='jsFaxValid();' id='strFax' class='controlText' type='text' value=\"$strFax\" name='strFax' ></td>
						<td align='right' width='50px'></td>
					</tr>
				</table>
				<div id='ErrorContent_strFax' class='Error_Text'></div>
				<div style='border-bottom:1px groove #333;'></div>

				<table width='100%' style='margin-top:12px;'>
					<tr>
						<td><label for='OptionA1'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["strEmail"].":</label>$imgRequired</td>
						<td align='right'><input $readonly onchange='jsEmailValid();' id='strEmail' class='controlText' type='text' value=\"$strEmail\" name='strEmail' ></td>
						<td align='right' width='50px'>
							<div class='Tooltip'>
								<div id='FaqIDx_13' class='Tooltip_Icon' onClick='jsHoverTooltip(13);'><img width='25px' height='25px' src='images/question-icon.png' /></div>
							</div>
						</td>
					</tr>
				</table>
				<div id='ErrorContent_strEmail' class='Error_Text'></div>
				<div id='FaqContent_13' class='Tooltip_Text'>".MemberRegistration::GetTooltip(13)."</div>
				<table width='100%' >
					<tr>
						<td><label for='OptionA1'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["strPassword"].":</label>$imgRequired</td>
						<td align='right'>
							<input onchange='jsPasswordValid();' id='strPassword' class='controlText' type='password' value='' name='strPassword' >
							<div id='bMemberName'>". $_TRANSLATION[$_SESSION[LANGUAGE]]["isCaseSensitive"] ."</div>
						</td>
						<td align='right' width='50px'>
							<div class='Tooltip'>
								<div id='FaqIDx_14' class='Tooltip_Icon' onClick='jsHoverTooltip(14);'><img width='25px' height='25px' src='images/question-icon.png' /></div>
							</div>
						</td>
					</tr>
				</table>
				<div id='ErrorContent_strPassword' class='Error_Text'></div>
				<table width='100%' >
					<tr>
						<td><label for='OptionA1'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["strPasswordConfirm"].":</label>$imgRequired</td>
						<td align='right'><input onchange='jsPasswordValid();' id='strPasswordConfirm' class='controlText' type='password' value='' name='strPasswordConfirm' ></td>
						<td align='right' width='50px'></td>
					</tr>
				</table>
				<div id='ErrorContent_strPasswordConfirm' class='Error_Text'></div>
				<div id='FaqContent_14' class='Tooltip_Text'>".MemberRegistration::GetTooltip(14)."</div>

				<div align='center' id='msgPendingDraft' > </div>
				<div style='border-bottom:1px groove #333;'></div>

				<table width='100%' style='margin-top:12px;' >
					<tr>
						<td><label for='OptionA1'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["strLanguage"].":</label>$imgRequired</td>
						<td align='right'>
							<select id='strLanguage' name='strLanguage' class='controlText'>
								<option value='0'> ". $_TRANSLATION[$_SESSION[LANGUAGE]]["optSelect"] ." </option>
								$ddlLanguage
							</select>
						</td>
						<td align='right' width='50px'> </td>
					</tr>
				</table>

			</div>
			<input type='hidden' value='1' name='saveData' />
			<input type='hidden' id='UserID' name='UserID' value='$UserID' />
			<input type='hidden' id='MemberID' name='MemberID' value='$MemberID' />";

		## JAVASCRIPT

		if(($_SESSION[S3REGISTRATION]->UserID == "") || (!isset($_SESSION[S3REGISTRATION]->UserID)))
		{
			$MemberSpecific = "  if(($('#strPassword').val() == '') || ($('#strPassword').val() == ' '))
										{
											$('#ErrorContent_strPassword').html('".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strPassword_strong"]."')
											$('#ErrorContent_strPassword').slideDown('fast');
											msg += '".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strPassword_strong"]." \\n'
										}
										else
										{
											emailVal = $('#strPassword').val();

											if(emailVal.length >= 8)
											{
												if(emailVal.length >= 15)
												{
													verdict = false;
												}
												else
												{
													verdict = /^[A-Za-z0-9\d=!\-@._*]*$/.test(emailVal) && /[A-Z]/.test(emailVal) && /\d/.test(emailVal) ;
												}
											}
											else
											{
												verdict = false;
											}

											if(verdict == false)
											{
												$('#ErrorContent_strPassword').html('".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strPassword_strong"]."')
												$('#ErrorContent_strPassword').slideDown('fast');
												msg += '".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strPassword_strong"]." \\n'
											}
										}

										if(($('#strPassword').val() != $('#strPasswordConfirm').val()) && ($('#strPasswordConfirm').val() != ''))
										{
											$('#ErrorContent_strPasswordConfirm').html('".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strPasswordConfirm"]."')
											$('#ErrorContent_strPasswordConfirm').slideDown('fast');
											msg += '".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strPasswordConfirm"]." \\n'
										} 

										";

			 $MemberSpecificEmail = "  if(($('#strEmail').val() == '') || ($('#strEmail').val() == ' '))
												{
													$('#ErrorContent_strEmail').html(\"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strEmail"]."\")
													$('#ErrorContent_strEmail').slideDown('fast');
													msg += \"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strEmail"]." \\n\"
												}
												else
												{
													var pattern = new RegExp(/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/);
													emailVal = $('#strEmail').val();

													verdict = pattern.test(emailVal);
													if(verdict == false)
													{
														$('#ErrorContent_strEmail').html(\"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strEmail_Invalid"]."\")
														$('#ErrorContent_strEmail').slideDown('fast');
														msg += \"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strEmail_Invalid"]." \\n\"
													}
													else
													{

															Email = $('#strEmail').val();

															$.ajax(
															{
																type: 'POST',
																async: false,
																url: 'ajaxfunctions.php',
																data: 'header=text&type=emailExist&strEmail=' + Email,
																success: function(data)
																{
																	if(data == 1)
																	{
																		$('#ErrorContent_strEmail').html(\"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strEmail_exist"]."\")
																		$('#ErrorContent_strEmail').slideDown('fast');
																		msg += \"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strEmail_exist"]." \\n\"
																	}
																}
															});
													}
												}   ";
		}
		else
		{
			$MemberSpecific = "  
											if(($('#strPassword').val() != $('#strPasswordConfirm').val()) && ($('#strPasswordConfirm').val() != ''))
											{
												$('#ErrorContent_strPasswordConfirm').html('".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strPasswordConfirm"]."')
												$('#ErrorContent_strPasswordConfirm').slideDown('fast');
												msg += '".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strPasswordConfirm"]." \\n'
											} 
									  ";

			$MemberSpecificEmail = "  ";
		}



		$JS = "  <script>
			var msg = '';

					function jsTelValid()
					{
						$('#ErrorContent_strTel').slideUp('fast');

						if(($('#strTel').val() == '') || ($('#strTel').val() == ' '))
						{
							$('#ErrorContent_strTel').html(\"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strTel"]."\")
							$('#ErrorContent_strTel').slideDown('fast');
							msg += \"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strTel"]." \\n\"
						}
						else
						{

							telVal = $('#strTel').val();
							var TelephoneNo = isNaN(telVal);

							 if(telVal.length != 7 || TelephoneNo == true)
							 {
								  $('#ErrorContent_strTel').html(\"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strTel_Invalid"]."\")
								  $('#ErrorContent_strTel').slideDown('fast');
								  msg += \"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strTel_Invalid"]." \\n\"
							 }

						}
					}

					function jsAreaCodeValid()
					{
						 $('#ErrorContent_strArea').slideUp('fast');

						if(($('#strAreaCode').val() == '') || ($('#strAreaCode').val() == ' '))
						{
							$('#ErrorContent_strArea').html(\"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strTel_Area"]."\")
							$('#ErrorContent_strArea').slideDown('fast');
							msg += \"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strTel_Area"]." \\n\"
						}
						else
						{

						  var AreaCode;

						  strAreaCode = $('#strAreaCode').val();

						  var AreaCodeNumOne = strAreaCode.substring(0,1);
						  var firstAreaCodeNum = isNaN(AreaCodeNumOne);

						  var AreaCodeNumTwo = strAreaCode.substring(1,2);
						  var secondAreaCodeNum = isNaN(AreaCodeNumTwo);

						  var AreaCodeNumThree = strAreaCode.substring(2,3);
						  var thirdAreaCodeNum = isNaN(AreaCodeNumThree);


						  if(firstAreaCodeNum == true || secondAreaCodeNum == true || thirdAreaCodeNum == true)
						  {
							 AreaCode = false; //One of the three characters is not numeric
						  }
						  else
							 if(firstAreaCodeNum == false && secondAreaCodeNum == false && thirdAreaCodeNum == false)
							 {
								AreaCode = true; // All of the charaters are numeric
							 }

						  if(strAreaCode.length != 3 || AreaCode == false)
						  {
								$('#ErrorContent_strArea').html(\"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strTel_Area"]."\")
								$('#ErrorContent_strArea').slideDown('fast');
								msg += \"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strTel_Area"]." \\n\"
						  }

						}
					}

					function jsCellValid()
					{
						$('#ErrorContent_strCell').slideUp('fast');

						if(($('#strCell').val() == '') || ($('#strCell').val() == ' '))
						{
						}
						else
						{
						  strCell = $('#strCell').val();
							var cellNumber = isNaN(strCell);

							if(strCell.length != 10  || cellNumber == true)
								{
									$('#ErrorContent_strCell').html(\"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strCell"]."\")
									$('#ErrorContent_strCell').slideDown('fast');
									msg += \"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strCell"]." \\n\"
								}
						}
					}

					function jsFaxValid()
					{
						$('#ErrorContent_strFax').slideUp('fast');

						if(($('#strFax').val() == '') || ($('#strFax').val() == ' '))
						{
						}
						else
						{
							strFax = $('#strFax').val();
							var faxNumber = isNaN(strFax);

							if(strFax.length != 10 || faxNumber == true)
								{
									$('#ErrorContent_strFax').html(\"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strFax"]."\")
									$('#ErrorContent_strFax').slideDown('fast');
									msg += \"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strFax"]." \\n\"
								}
						}
					}

					function jsEmailValid()
					{
						$('#ErrorContent_strEmail').slideUp('fast');

						$MemberSpecificEmail

					}
					function jsPasswordValid()
					{
						$('#ErrorContent_strPassword').slideUp('fast');
						$('#ErrorContent_strPasswordConfirm').slideUp('fast');

						$MemberSpecific
					}

					// PAGE VALIDATION ///////////////////////////////////////////////////////////////////////
					function jsValidation()
					{

						$('.Error_Text').slideUp('fast');
							msg = '';

						msg = '';

						if(($('#strTitle').val() == '') || ($('#strTitle').val() == ' '))
						{
							$('#ErrorContent_strTitle').html(\"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strTitle"]."\")
							$('#ErrorContent_strTitle').slideDown('fast');
							msg += \"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strTitle"]." \\n\"
						}

						if(($('#strName').val() == '') || ($('#strName').val() == ' '))
						{
							$('#ErrorContent_strName').html(\"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strName"]."\")
							$('#ErrorContent_strName').slideDown('fast');
							msg += \"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strName"]." \\n\"
						}

						if(($('#strSurname').val() == '') || ($('#strSurname').val() == ' '))
						{
							$('#ErrorContent_strSurname').html(\"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strSurname"]."\")
							$('#ErrorContent_strSurname').slideDown('fast');
							msg += \"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strSurname"]." \\n\"
						}

						if(($('#strTel').val() == '') || ($('#strTel').val() == ' '))
						{
							$('#ErrorContent_strTel').html(\"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strTel"]."\")
							$('#ErrorContent_strTel').slideDown('fast');
							msg += \"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strTel"]." \\n\"
						}
						else
						{
							//var pattern = new RegExp(/[0-9 -()+]+$/);
							telVal = $('#strTel').val();
							//verdict = pattern.test(telVal);

							verdict = isNaN(telVal);

							if(verdict == true)
							{
								$('#ErrorContent_strTel').html(\"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strTel_Invalid"]."\")
								$('#ErrorContent_strTel').slideDown('fast');
								msg += \"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strTel_Invalid"]." \\n\"
							}
							else
							{
								if(telVal.length != 7)
								{
									$('#ErrorContent_strTel').html(\"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strTel_Invalid"]."\")
									$('#ErrorContent_strTel').slideDown('fast');
									msg += \"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strTel_Invalid"]." \\n\"
								}
							}
						}

						if(($('#strCell').val() == '') || ($('#strCell').val() == ' '))
						{
						}
						else
						{

						  strCell = $('#strCell').val();

							var cellNumber = isNaN(strCell);

							if(strCell.length != 10  || cellNumber == true)
								{
									$('#ErrorContent_strCell').html(\"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strCell"]."\")
									$('#ErrorContent_strCell').slideDown('fast');
									msg += \"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strCell"]." \\n\"
								}
						}

						if(($('#strFax').val() == '') || ($('#strFax').val() == ' '))
						{
						}
						else
						{
							strFax = $('#strFax').val();

							 var faxNumber = isNaN(strFax);

							if(strFax.length != 10 || faxNumber == true)
								{
									$('#ErrorContent_strFax').html(\"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strFax"]."\")
									$('#ErrorContent_strFax').slideDown('fast');
									msg += \"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strFax"]." \\n\"
								}
						}

						$MemberSpecificEmail

						$MemberSpecific

						if($('#strLanguage').val() == 0)
						{
							$('#ErrorContent_strLanguage').html(\"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strLanguage"]."\")
							$('#ErrorContent_strLanguage').slideDown('fast');
							msg += \"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strLanguage"]." \\n\"
						}

							if(msg != '')
							{
								//alert(msg);
								return false;
							}
							return true;
						}

					function jsToggleInfo(ToggleID)
					{
						$('#'+ToggleID).toggle('fast')
					}

					</script>";

		## RETURN
		return $Content . $JS;
	}

	## GET THE USER TYPE CONTENT ###########################################################################################################################################################
	########################################################################################################################################################################################
	########################################################################################################################################################################################

	function getUserTypeContent()
	{
		## GLOBAL VARS
		global $xdb, $arrSys, $TR, $SP, $HR, $DATABASE_SETTINGS, $SystemSettings, $BR, $_TRANSLATION;

		## INI

		## COLUMN WIDTH
		$ColumWidthLabel = "width= '20%'";
		$ColumWidthInput = "width= '35%'";
		$ColumWidthIcon = "width= '5%'";
		$ColumWidthComment = "width= '40%'";

		## LOAD

		## HTML CONTENT
		$Content = "<div>
							<div id='ErrorContent_Main' class='Error_Text'></div>
								<table width='100%'>
									<tr>
										<td>
											<input id='Option1' type='radio' ". ($_SESSION[Wizzard]->ActiveParent == "NewMember" ? "checked" : "")." name='chkUserType' value='NewMember' onclick='' /> <label for='Option1'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["UserType1"]."</label>
											<label id='lbl_Option1' class='RequiredFieldIndicatorChanger'></label>
										</td>
										<td align='right'></td>
										<td align='right' width='50px'>
											<div class='Tooltip'><div id='FaqIDx_2' class='Tooltip_Icon' onClick='jsHoverTooltip(2);'><img width='25px' height='25px' src='images/info-icon.png' /></div></div>
										</td>
									</tr>
								</table>
								<div id='FaqContent_2' class='Tooltip_Text'>".MemberRegistration::GetTooltip(20)."</div>

								<div style='border-bottom:1px groove #333;'></div>$BR

								<table width='100%'>
									<tr>
										<td>
											<input id='Option2' type='radio' ". ($_SESSION[Wizzard]->ActiveParent == "SelectMember" ? "checked" : "")." name='chkUserType' value='SelectMember' onclick='' /> <label for='Option2'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["UserType2"]."</label>
											<label id='lbl_Option2' class='RequiredFieldIndicatorChanger'></label>
										</td>
										<td align='right'></td>
										<td align='right' width='50px'>
											<div class='Tooltip'><div id='FaqIDx_3' class='Tooltip_Icon' onClick='jsHoverTooltip(3);'><img width='25px' height='25px' src='images/info-icon.png' /></div></div>
										</td>
									</tr>
								</table>
								<div id='FaqContent_3' class='Tooltip_Text'>".MemberRegistration::GetTooltip(21)."</div>
								<input type='hidden' value='1' name='saveData' />
						</div>";

		## RETURN
		return $Content;
	}

	## GET THE MEMBERSHIP DETAILS CONTENT ##################################################################################################################################################
	########################################################################################################################################################################################
	########################################################################################################################################################################################

	function getLinkedMemberContent()
	{
		## GLOBAL VARS
		global $xdb, $arrSys, $TR, $SP, $HR, $DATABASE_SETTINGS, $SystemSettings, $BR, $_TRANSLATION;
		
		## HTML CONTENT
		$strContent = "<div>
								<table width='100%'>
									<tr>
										<td><label for=''>".$_TRANSLATION[$_SESSION[LANGUAGE]]["MemberID"].":</label>$imgRequired</td>
										<td align='right'>
											<input style='width:171px;' onchange='' id='MemberID' class='controlText' type='text' value='' name='MemberID' >
											".$_TRANSLATION[$_SESSION[LANGUAGE]]["checkBtn"]."
											<div id='linkMemberName' style='font-weight:bold; font-size:13px;'> </div>
											<input type='hidden' id='btnConinueLink' name='btnConinueLink' value='0' />
										</td>
										<td align='right' width='50px'><input type='hidden' value='1' name='saveData' /></td>
									</tr>
								</table>
								<div id='ErrorLink' class='Error_Text'></div>
							</div>

							<script>


								function jsGetMemberDetails()
								{
									tmpMemberID = $('#MemberID').val();
									$('#bMemberName').hide('fast');

									$.ajax(
									{
										type: 'POST',
										url: 'ajaxfunctions.php',
										data: 'header=text&type=getMemberDetails&tmpMemberID=' + tmpMemberID,
										success: function(data)
										{
											try{
												if(data != 0)
												{
													$('#linkMemberName').html(data)
													$('#btnConinueLink').val('1')
												}
												else
												{
													$('#linkMemberName').html('". $_TRANSLATION[$_SESSION[LANGUAGE]]["MemberSearchPromp"] ."')
													$('#btnConinueLink').val('0')

												}
											}catch(e){}
											finally{
												$('#bMemberName').show('fast');
											}
										}
									});
								}


								function jsValidation()
								{

									$('.Error_Text').slideUp('fast');
									msg = '';

									if($('#btnConinueLink').val() == 0)
									{
										$('#ErrorLink').html('".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_link"]."')
										$('#ErrorLink').slideDown('fast');
										msg += '".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_link"]." \\n'
									}

									if(msg != '')
									{
										return false;
									}
									return true;
								}

							</script>
							";

		## RETURN
		return $strContent;
	}

	## GET THE MEMBERSHIP DETAILS CONTENT ##################################################################################################################################################
	########################################################################################################################################################################################
	########################################################################################################################################################################################

	function getMembershipDetailsContent()
	{
		## GLOBAL VARS
		global $xdb, $arrSys, $TR, $SP, $HR, $DATABASE_SETTINGS, $SystemSettings, $BR, $_TRANSLATION;

		## INI ## :)
		$refMemberTypeID = "";
		$strSARSPackhouseNumber = "";


		if($_SESSION[Wizzard]->ActiveParent == "SelectMember")
		{

		}
		else if($_SESSION[Wizzard]->ActiveParent == "NewMember")
		{

		}

		## IF MEMBER EXIST GET DETAILS AND FILL FORM
		if($_SESSION[S3REGISTRATION]->MemberID != "")
		{
			## GET MEMBER AND USER DETAILS
			$MemberID = $_SESSION[S3REGISTRATION]->MemberID;
			$row = $xdb->getRowSQL("SELECT *
											FROM sysUser LEFT JOIN tmpMember ON sysUser.refMemberID = tmpMember.MemberID
											WHERE refMemberID = '".$_SESSION[S3REGISTRATION]->MemberID ."'");

			## UPDATE VARS
			$refMemberTypeID = $row->refMemberTypeID;
			$strSARSPackhouseNumber = $row->strSARSPackhouseNumber;
		}


		## GET ARUMANTS ARRAY
		$Args = unserialize($row->RegistrationArgs);



		if(!isset($_SESSION[S3REGISTRATION]->MemberID))
		{
		  $refMemberTypeID = $_SESSION[S3REGISTRATION]->refMembershipType;
		  $Args[blnGrapeProducer] = $_SESSION[S3REGISTRATION]->blnGrapeProducer;
		}

		$DChecked = ""; 
		if(($refMemberTypeID == 9) && ($Args[blnGrapeProducer] == "D"))
		{
			$refMemberTypeID = 64;
		}
		else if($Args[blnGrapeProducer] == "D")
		{
			$DChecked = "checked='checked'";
		}

		## CHECK CORRECT MEMBERSHIP RADIO BUTTON
		$A1Checked =
		$A2Checked =
		$BChecked =
		$CChecked = "";

		$A1Disable =
		$A2Disable =
		$BDisable =
		$CDisable = "disabled='disabled'";

		switch($refMemberTypeID)
		{
			case 2: case 8: case 9: case 27: case 64: //'CELPVT','CELPRD','BOTCEL','MFRCON'
				$A1Checked = "checked='checked'";
				$A1Disable = "";
				break;

			case 48: case 58: case 59: case 60: case 61: //'WSL000','WSLWIN','WSLSPT','WSLSAW','WSLPRD'
				$A2Checked = "checked='checked'";
				$A2Disable = "";
				break;

			case 11: // 'CRT000'
			case 12: //'CRTPVT'
				$BChecked = "checked='checked'";
				$BDisable = "";

				if($Args[bMemberID] != "")
					$BValue = $Args[bMemberID];
				break;

			case 14: case 57: //y=> EXP000; n => WSLEXP
				$CChecked = "checked='checked'";
				$CDisable = "";
				break;
		}
		## CREATE CELLAR TYPE DROP DOWN
		$ddlCellerType = $xdb->ListOptions("SELECT MemberTypeID AS 'ControlValue', strMemberType AS 'ControlText'
			FROM vieMemberType_".$_SESSION[LANGUAGE]."
			WHERE strMemberTypeCode IN ('CELPVT','CELPVD','CELPRD','BOTCEL','MFRCON')
			ORDER BY ControlText ASC ", $refMemberTypeID);
		$ddlCellerType = "<select class='controlText clsMembershipType' onchange='jsUpdateRadioValue(\"OptionA1\", this.value);' id='Input_OptionA1' $A1Disable>
									<option value='0'>". $_TRANSLATION[$_SESSION[LANGUAGE]]["optSelect"] ."</option>
									$ddlCellerType
								</select>$BR";

		## CREATE WHOLESALER TYPE DROP DOWN
		$ddlWholesalerType = $xdb->ListOptions("SELECT MemberTypeID AS 'ControlValue', strMemberType AS 'ControlText'
			FROM vieMemberType_".$_SESSION[LANGUAGE]."
			WHERE strMemberTypeCode IN ('WSL000','WSLWIN','WSLSPT','WSLSAW','WSLPRD')
			ORDER BY ControlValue", $refMemberTypeID);
	  //print_rr($ddlWholesalerType);
		$ddlWholesalerType = "<select class='controlText clsMembershipType' onchange='jsUpdateRadioValue(\"OptionA2\", this.value);' id='Input_OptionA2' $A2Disable>
										<option value='0'>". $_TRANSLATION[$_SESSION[LANGUAGE]]["optSelect"] ."</option>
										$ddlWholesalerType
									</select>$BR";

		## COLUMN WIDTH
		$ColumWidthLabel = "width= '20%'";
		$ColumWidthInput = "width= '35%'";
		$ColumWidthIcon = "width= '5%'";
		$ColumWidthComment = "width= '40%'";

		## HTML CONTENT
		$strContent = "<div>
								<div id='ErrorContent_Main' class='Error_Text'></div>
								$BR
								".$_TRANSLATION[$_SESSION[LANGUAGE]]["TypeOfMembership"]."
								$BR$BR
								<table width='100%'>
									<tr>
										<td >
											<input id='OptionA1' $A1Checked type='radio' name='refMembershipType' value='$refMemberTypeID' onclick='jsMembershipEngine(this.id);' /> <label for='OptionA1'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["radOptionA1"]."</label>
											<label id='lbl_OptionA1' class='RequiredFieldIndicatorChanger'></label>
										</td>
										<td align='right'>$ddlCellerType</td>
										<td align='right' width='50px'>
											<div class='Tooltip'><div id='FaqIDx_3' class='Tooltip_Icon' onClick='jsHoverTooltip(3);'><img width='25px' height='25px' src='images/question-icon.png' /></div></div>
										</td>
									</tr>
								</table>
								<div id='FaqContent_3' class='Tooltip_Text'>".MemberRegistration::GetTooltip(3)."</div>
								<div id='ErrorContent_A1' class='Error_Text'></div>
								<table width='100%'>
									<tr>
										<td>
											<input id='OptionA2' $A2Checked type='radio' name='refMembershipType' value='$refMemberTypeID' onclick='jsMembershipEngine(this.id);' /> <label for='OptionA2'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["radOptionA2"]."</label>
											<label id='lbl_OptionA2' class='RequiredFieldIndicatorChanger'></label>
										</td>
										<td align='right'>$ddlWholesalerType</td>
										<td align='right' width='50px'>
											<div class='Tooltip'><div id='FaqIDx_4' class='Tooltip_Icon' onClick='jsHoverTooltip(4);'><img width='25px' height='25px' src='images/question-icon.png' /></div></div>
										</td>
									</tr>
								</table>
								<div id='FaqContent_4' class='Tooltip_Text'>".MemberRegistration::GetTooltip(4)."</div>
								<div id='ErrorContent_A2' class='Error_Text'></div>
								<table width='100%'>
									<tr>
										<td >
											<label for=''>".$_TRANSLATION[$_SESSION[LANGUAGE]]["PackhouseNumber"]."</label>

										</td>
										<td align='right'><input id='PackhouseNumber' onChange='jsValidPackhouse()' name='strSARSPackhouseNumber' type='text' class='controlText' value=\"$strSARSPackhouseNumber\" /></td>
										<td align='right' width='50px'>
											<div class='Tooltip'><div id='FaqIDx_9' class='Tooltip_Icon' onClick='jsHoverTooltip(9);'><img width='25px' height='25px' src='images/info-icon.png' /></div></div>
										</td>
									</tr>
								</table>
								<div id='FaqContent_9' style='display:block;' class='Tooltip_Text'>".MemberRegistration::GetTooltip(9)."</div>
								<div id='ErrorContent_Packhouse' class='Error_Text'></div>

								<div style='border-bottom:1px groove #333;'></div>$BR

								<table width='100%'>
									<tr>
										<td >
											<input id='OptionB' $BChecked type='radio' name='refMembershipType' value='11' onclick='jsMembershipEngine(this.id);' /> <label for='OptionB'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["radOptionB"]."</label>
											<label id='lbl_OptionB' class='RequiredFieldIndicatorChanger'></label>
										</td>
										<td align='right'>
											<input type='text' onchange='jsGetMemberDetails();' name='bMemberID' class='controlText clsMembershipType' value='$BValue' id='Input_OptionB' $BDisable placeholder='". $_TRANSLATION[$_SESSION[LANGUAGE]]["lblSearchPlaceholder"] ."'/>
											<div id='bMemberName'>". $_TRANSLATION[$_SESSION[LANGUAGE]]["lblSearchPromp"] ."</div>
										</td>
										<td align='right' width='50px'>
											<div class='Tooltip'><div id='FaqIDx_5' class='Tooltip_Icon' onClick='jsHoverTooltip(5);'><img width='25px' height='25px' src='images/question-icon.png' /></div></div>
										</td>
									</tr>
								</table>
								<div id='FaqContent_5' class='Tooltip_Text'>".MemberRegistration::GetTooltip(5)."</div>
								<div id='ErrorContent_B' class='Error_Text'></div>

								<div style='border-bottom:1px groove #333;'></div>$BR

								 <table width='100%'>
									<tr>
										<td >
											<input id='OptionC' $CChecked type='radio' name='refMembershipType' value='$refMemberTypeID' onclick='jsMembershipEngine(this.id);' /> <label for='OptionC'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["radOptionC"]."</label>
											<label id='lbl_OptionC' class='RequiredFieldIndicatorChanger'></label>
										</td>
										<td align='right'>
											". $_TRANSLATION[$_SESSION[LANGUAGE]]["lblBottledStock"] ." $SP
											<select class='controlText clsMembershipType' style='width:80px;' onchange='jsUpdateRadioValue(\"OptionC\", this.value);'  id='Input_OptionC' $CDisable>
												<option value='0'>". $_TRANSLATION[$_SESSION[LANGUAGE]]["optSelect"] ."</option>
												<option ". ($refMemberTypeID == 14 ? "selected" : "")." value='14'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["optYes"]."</option>
												<option ". ($refMemberTypeID == 57 ? "selected" : "")." value='57'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["optNo"]."</option>
											</select>
										</td>
										<td align='right' width='50px'>
											<div class='Tooltip'><div id='FaqIDx_6' class='Tooltip_Icon' onClick='jsHoverTooltip(6);'><img width='25px' height='25px' src='images/question-icon.png' /></div></div>
										</td>
									</tr>
								</table>
								<div id='FaqContent_6' class='Tooltip_Text'>".MemberRegistration::GetTooltip(6)."</div>
								<div id='ErrorContent_C' class='Error_Text'></div>

								<div style='border-bottom:1px groove #333;'></div>$BR

								<table width='100%'>
									<tr>
										<td ><input id='OptionD' type='radio' $DChecked name='refMembershipType' onClick='jsTriggerFAQ(7); jsMembershipEngine(this.id);' value='D' /> <label for='OptionD'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["chkOptionD"]."</label></td>
										<td align='right'> </td>
										<td align='right' width='50px'>
											<div class='Tooltip'><div id='FaqIDx_7' class='Tooltip_Icon' onClick='jsHoverTooltip(7);'><img width='25px' height='25px' src='images/info-icon.png' /></div></div>
										</td>
									</tr>
								</table>
								<div id='FaqContent_7' class='Tooltip_Text'>".MemberRegistration::GetTooltip(7)."</div>

							</div>
							<input type='hidden' value='1' name='saveData' />
							<input type='hidden' value='1' name='storeData' />
							<input type='hidden' id='UserID' name='UserID' value='$UserID' />
							<input type='hidden' id='MemberID' name='MemberID' value='$MemberID' />";

		## JAVASCRIPT
		$JS = "<script>

		$( document ).ready(function() {
			jsGetMemberDetails();
		});

		function jsValidPackhouse()
		{
			var phNumber  =  $('#PackhouseNumber').val();
			$('#ErrorContent_Packhouse').slideUp('fast'); 
			//17082015 - CHECKING EACH OF THE FIRST 3 LETTERS INDIVIDUALLY - D

			var charOne = phNumber.substring(0,1);
			var isOneChar = isNaN(charOne);

			var charTwo = phNumber.substring(1,2);
			var isTwoChar = isNaN(charTwo);

			var charThree = phNumber.substring(2,3);
			var isThreeChar = isNaN(charThree);


			if(phNumber != '' && phNumber != ' ')
			{
				if(isOneChar == true && isTwoChar == true && isThreeChar == true)
				{

					isChar = true;

					var restOfString = phNumber.slice(3);
					var isNum = isNaN(restOfString);

					if(isChar == true && isNum == false)
					{
					}
					else
					{
						$('#ErrorContent_Packhouse').html('".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_Warehouse"]."')
						$('#ErrorContent_Packhouse').slideDown('fast');
						msg += 'Your warehouse number is incorrect. \\n'
					}
				}
				else
				{
					$('#ErrorContent_Packhouse').html('".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_Warehouse"]."')
					$('#ErrorContent_Packhouse').slideDown('fast');
					msg += 'Your warehouse number is incorrect. \\n'
				}
			}
		}


	// THIS FUNCTION HANDLES MEMBERSHIP SWITCHES ////////////////////////////////////////////
	function jsMembershipEngine(idx)
	{
		if($('#'+idx).is(':checked'))
		{
		}

		$('.clsMembershipType').attr('disabled','disabled');

		$('#Input_'+idx).removeAttr('disabled');
		if(idx != 'OptionB')
		{
			$('.RequiredFieldIndicatorChanger').html('');
			$('#lbl_'+idx).html('*');
		} 
		
	}

	// UPDATE THE MEMBERSHIP CODE ///////////////////////////////////////////////////////////
	function jsUpdateRadioValue(radID, xval)
	{
		$('#'+radID).val(xval);

		if(xval == 64)
			jsTriggerFAQ(7);
		else
			$('#FaqContent_7').hide();

	}

	// PAGE VALIDATION ///////////////////////////////////////////////////////////////////////
	function jsValidation()
	{

		$('.Error_Text').slideUp('fast');
		msg = '';



		if($('input[name=\"refMembershipType\"]:checked').val() == 'Y')
		{
			$('#ErrorContent_Y').html('Please follow the login prosess to continue.')
			$('#ErrorContent_Y').slideDown('fast');
			msg = 'Please follow the login prosess to continue. \\n'
		}
		else
		{
			if(!$('#Input_OptionA1').is(':disabled'))
			{
				if($('#Input_OptionA1').val() == 0)
				{
					$('#ErrorContent_A1').html(\"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_A1"]."\")
					$('#ErrorContent_A1').slideDown('fast');
					msg += \"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_A1"]." \\n\"
				}
			}

			if(!$('#Input_OptionA2').is(':disabled'))
			{
				if($('#Input_OptionA2').val() == 0)
				{
					$('#ErrorContent_A2').html(\"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_A2"]."\")
					$('#ErrorContent_A2').slideDown('fast');
					msg += \"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_A2"]." \\n\"
				}
			}

			/*if(!$('#Input_OptionB').is(':disabled'))
			{
				if($('#Input_OptionB').val() == '')
				{
					$('#ErrorContent_B').html('".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_B"]."')
					$('#ErrorContent_B').slideDown('fast');
					msg += '".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_B"]." \\n'
				}
			}*/
			
			if(!$('#Input_OptionC').is(':disabled'))
			{
				if($('#Input_OptionC').val() == 0)
				{
					$('#ErrorContent_C').html('".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_C"]."')
					$('#ErrorContent_C').slideDown('fast');
					msg += '".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_C"]." \\n'
				}
			}

			if (!$('input[name=\"refMembershipType\"]:checked').length)
			{
				$('#ErrorContent_Main').html('".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_refMembershipType"]."')
				$('#ErrorContent_Main').slideDown('fast');
				msg += '".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_refMembershipType"]." \\n'
			}

			// if($('#PackhouseNumber').val() == '')
			// {
			//    $('#ErrorContent_Packhouse').html('Please provide your Packhouse number.')
			//    $('#ErrorContent_Packhouse').slideDown('fast');
			//    msg += 'Please provide your Packhouse number. \\n'
			// }

			var phNumber  =  $('#PackhouseNumber').val();

			//17082015 - CHECKING EACH OF THE FIRST 3 LETTERS INDIVIDUALLY - D

			var charOne = phNumber.substring(0,1);
			var isOneChar = isNaN(charOne);

			var charTwo = phNumber.substring(1,2);
			var isTwoChar = isNaN(charTwo);

			var charThree = phNumber.substring(2,3);
			var isThreeChar = isNaN(charThree);


			if(phNumber != '' && phNumber != ' ')
			{
				if(isOneChar == true && isTwoChar == true && isThreeChar == true)
				{

					isChar = true;

					var restOfString = phNumber.slice(3);
					var isNum = isNaN(restOfString);

					if(isChar == true && isNum == false)
					{
					}
					else
					{
						$('#ErrorContent_Packhouse').html('".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_Warehouse"]."')
						$('#ErrorContent_Packhouse').slideDown('fast');
						msg += 'Your warehouse number is incorrect. \\n'
					}
				}
				else
				{
					$('#ErrorContent_Packhouse').html('".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_Warehouse"]."')
					$('#ErrorContent_Packhouse').slideDown('fast');
					msg += 'Your warehouse number is incorrect. \\n'

				}
			}
		}

		if(msg != '')
		{
			return false;
		}
		return true;
	}

	// CHECK IF LOGIN EXIST //////////////////////////////////////////////////////////////////
	function jsGetMemberDetails()
	{
		tmpMemberID = $('#Input_OptionB').val();

		$.ajax(
		{
			type: 'POST',
			url: 'ajaxfunctions.php',
			data: 'header=text&type=getMemberDetails&tmpMemberID=' + tmpMemberID,
			success: function(data)
			{
				try{
					$('#bMemberName').hide('fast');
					if(data != 0)
					{
						$('#bMemberName').html(data)
					}
					else
					{
						$('#bMemberName').html('". $_TRANSLATION[$_SESSION[LANGUAGE]]["lblSearchPromp"] ."')

					}
				}catch(e){}
				finally{
					$('#bMemberName').show('fast');
				}
			}
		});
	}

		</script>";

		## RETURN
		return $strContent . $JS;
	}



	function getMemberDetailsContent()
	{
		## GLOBAL VARS
		global $xdb, $arrSys, $BR, $TR, $SP, $HR, $DATABASE_SETTINGS, $SystemSettings, $imgRequired, $_LANGUAGE, $_TRANSLATION ;

		## INI ## :)

		//load

		## GET MEMBER AND USER DETAILS
		// $row = $xdb->getRowSQL("SELECT *
		//                         FROM sysUser LEFT JOIN tblMember ON sysUser.refMemberID = tblMember.MemberID
		//                         WHERE refMemberID = '".$_SESSION[S3REGISTRATION]->MemberID ."'",1);
		$row = $xdb->getRowSQL("SELECT * FROM tmpMember
										WHERE MemberID = '".$_SESSION[S3REGISTRATION]->MemberID ."'",0);

		## GET USER DETAILS
		$rowUser = $xdb->getRowSQL("SELECT * FROM sysUser WHERE UserID = '" . $_SESSION[S3REGISTRATION]->UserID . "'");




		## UPDATE VARS
		$strMember = $row->strMember;
		$strLegalEntityType = $row->strLegalEntityType;
		$strRegistrationNumber = $row->strRegistrationNumber;
		$strVATRegistrationNumber = $row->strVATRegistrationNumber;
		$txtPostalAddress = $row->txtPostalAddress;
		$txtPhysicalAddress = $row->txtPhysicalAddress;


		$strContact = $row->strContact;
		$strTel = $row->strTel;
		$strCell = $row->strCell;
		$strFax = $row->strFax;
		$strEmail = $row->strEmail;
		$strWebsiteURL = $row->strWebsiteURL;
		$strCorrespondenceLanguage = "strSetting:CorrespondenceLanguage"; $strCorrespondenceLanguage = $row->$strCorrespondenceLanguage;

		if($strTitle == "") { $strTitle = $rowUser->strTitle; }
		if($strName == "") { $strName = $rowUser->strName; }
		if($strSurname == "") { $strSurname = $rowUser->strSurname; }
		if($strTel == "") { $strTel = $rowUser->strTel; }
		if($strCell == "") { $strCell = $rowUser->strCell; };
		if($strFax == "") { $strFax = $rowUser->strFax; };
		if($strEmail == "") { $strEmail = $rowUser->strEmail; };
		if($strWebsiteURL == "") { $strWebsiteURL = $rowUser->strWebsiteURL; };

		$UserID = $_SESSION[S3REGISTRATION]->UserID;
		$MemberID = $_SESSION[S3REGISTRATION]->MemberID;

		if($strVATRegistrationNumber == "")
		{
			$showVATReg = "display:none;";
			$radVatRegNo = "checked";
			//$radVatRegNo = "checked"; //do not check No automatically else it will default on first run
		}else{
			$showVATReg = "";
			$radVatRegYes = "checked";
		}

		## STRIPPING THE TELEPHONE NUMBER OF THE AREA CODE
		$telNo =  explode("-", $strTel);
		$strAreaCode = $telNo[0];
		$strTel = $telNo[1];

		$ddlLanguage = "";
		foreach($_LANGUAGE AS $key => $arrLanguageDetails)
		{
			$ddlLanguage .= "<option ". ($strCorrespondenceLanguage == $arrLanguageDetails->strLanguage ? "selected" : "").">$arrLanguageDetails->strLanguage</option>";
		}

		//after LOAD!!
		$_TRANSLATION["EN"]["ddllegalEntityType"] = "
			<option value='Closed Corporation' ". ($strLegalEntityType == "Closed Corporation" ? "selected" : "").">Closed Corporation</option>
			<option value='Company' ". ($strLegalEntityType == "Company" ? "selected" : "").">Company</option>
			<option value='Partnership' ". ($strLegalEntityType == "Partnership," ? "selected" : "").">Partnership</option>
			<option value='Sole Proprietor' ". ($strLegalEntityType == "Sole Proprietor" ? "selected" : "").">Sole Proprietor</option>
			<option value='Trust' ". ($strLegalEntityType == "Trust" ? "selected" : "").">Trust</option>";

		$_TRANSLATION["AF"]["ddllegalEntityType"] = "
			<option value='Sole Proprietor' ". ($strLegalEntityType == "Sole Proprietor" ? "selected" : "").">Beslote Korporasie</option>
			<option value='Closed Corporation' ". ($strLegalEntityType == "Closed Corporation" ? "selected" : "").">Maatskappy</option>
			<option value='Company' ". ($strLegalEntityType == "Company" ? "selected" : "").">Vennootskap</option>
			<option value='Trust' ". ($strLegalEntityType == "Trust" ? "selected" : "").">Eenmansaak</option>
			<option value='Partnership' ". ($strLegalEntityType == "Partnership," ? "selected" : "").">Trust</option>";

		//output
		## HTML CONTENT
		$Content = "
			<div>
				<table width='100%'>
					<tr>
						<td><label for='strMember'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["strMember"].":</label>$imgRequired</td>
						<td align='right'><input id='strMember' onchange='jsGetBusinessName();' class='controlText' type='text' value=\"$strMember\" name='strMember' />  </td>
						<td align='right' width='50px'></td>
					</tr>
				</table>
				<div id='ErrorContent_strMember' class='Error_Text'></div>
				<table width='100%'>
					<tr>
						<td><label for='strLegalEntityType'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["strLegalEntityType"].":</label>$imgRequired</td>
						<td align='right'>
							<select id='strLegalEntityType' class='controlText' name='strLegalEntityType' onchange='jsChangeRequired(\"insertRequired\")'>
								<option value='0'>". $_TRANSLATION[$_SESSION[LANGUAGE]]["optSelect"] ."</option>
								".$_TRANSLATION[$_SESSION[LANGUAGE]]["ddllegalEntityType"]."
							</select>
						</td>
						<td align='right' width='50px'></td>
					</tr>
				</table>
				<div id='ErrorContent_strLegalEntityType' class='Error_Text'></div>
				<table width='100%'>
					<tr>
						<td><label for='strRegistrationNumber'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["strRegistrationNumber"].":</label><span id='insertRequired'></span></td>
						<td align='right'><input id='strRegistrationNumber' onchange='jsGetRegistrationNumber();' class='controlText' type='text' value=\"$strRegistrationNumber\" name='strRegistrationNumber' />  </td>
						<td align='right' width='50px'></td>
					</tr>
				</table>
				<div id='ErrorContent_strRegistrationNumber' class='Error_Text'></div>
				<table width='100%'>
					<tr>
						<td><label for='strVATRegistrationNumber'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["strVATRegistrationNumber?"].":</label></td>
						<td align='right'>
							$SP $SP $SP $SP $SP
							<input type='radio' onclick='jsVatNumber();' name='radVatNumber' id='radVatNumberNo' value='0' $radVatRegNo />
							$SP<label for='radVatNumberNo' >".$_TRANSLATION[$_SESSION[LANGUAGE]]["optNo"]."</label>
							$SP $SP $SP $SP $SP
							<input type='radio' onclick='jsVatNumber();' name='radVatNumber' id='radVatNumberYes' value='1' $radVatRegYes />
							$SP<label for='radVatNumberYes'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["optYes"]."</label>
						</td>
						<td align='right' width='50px'><div class='Tooltip'><div id='FaqIDx_19' class='Tooltip_Icon' onClick=''><img width='25px' height='25px' src='images/info-icon.png' /></div></div></td>
					</tr>
				</table>
				<div id='ErrorContent_radVatNumber' class='Error_Text'></div>

				<table width='100%' style='$showVATReg' id='strVatNumber'>
					<tr>
						<td><label for='strVATRegistrationNumber'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["strVATRegistrationNumber"].":</label>$imgRequired</td>
						<td align='right'><input id='strVATRegistrationNumber' onchange='jsGetVATRegistrationNumber();' class='controlText' type='text' value=\"$strVATRegistrationNumber\" name='strVATRegistrationNumber' />  </td>
						<td align='right' width='50px'></td>
					</tr>
				</table>
				<div id='ErrorContent_strVATRegistrationNumber' class='Error_Text'></div>
				<div id='FaqContent_19' class='Tooltip_Text' style='display:block'>".MemberRegistration::GetTooltip(19)."</div>

				<div style='border-bottom:1px groove #333;'></div>
				<table width='100%' style='margin-top:12px;'>
					<tr>
						<td><label for='txtPostalAddress'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["txtPostalAddress"].":</label>$imgRequired</td>
						<td align='right'><textarea class='controlText' id='txtPostalAddress' name='txtPostalAddress' class='controlText'>$txtPostalAddress</textarea> </td>
						<td align='right' width='50px'></td>
					</tr>
				</table>
				<div id='ErrorContent_txtPostalAddress' class='Error_Text'></div>
				<table width='100%'>
					<tr>
						<td><label for='txtPhysicalAddress'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["txtPhysicalAddress"].":</label>$imgRequired</td>
						<td align='right'><textarea class='controlText' id='txtPhysicalAddress' name='txtPhysicalAddress' class='controlText'>$txtPhysicalAddress</textarea></td>
						<td align='right' width='50px'></td>
					</tr>
				</table>
				<div id='ErrorContent_txtPhysicalAddress' class='Error_Text'></div>

				<table width='100%'>
					<tr>
						<td> </td>
						<td align='right'><input onClick='jsCopyAddress();' type='button' value='".$_TRANSLATION[$_SESSION[LANGUAGE]]["btnCopyPostal"]."' class='controlButton' /></td>
						<td align='right' width='50px'></td>
					</tr>
				</table>
				<div style='border-bottom:1px groove #333;'></div>
				<table width='100%' style='margin-top:12px;'>
					<tr>
						<td><label for='OptionA1'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["strTitle"].":</label>$imgRequired</td>
						<td align='right'><input id='strTitle' class='controlText' type='text' value=\"$strTitle\" name='strTitle' />  </td>
						<td align='right' width='50px'></td>
					</tr>
				</table>
				<div id='ErrorContent_strTitle' class='Error_Text'></div>
				<table width='100%'>
					<tr>
						<td><label for='OptionA1'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["strName"].":</label>$imgRequired</td>
						<td align='right'><input id='strName' class='controlText' type='text' value=\"$strName\" name='strName' />  </td>
						<td align='right' width='50px'></td>
					</tr>
				</table>
				<div id='FaqContent_3' class='Tooltip_Text'></div>
				<div id='ErrorContent_strName' class='Error_Text'></div>
				<table width='100%'>
					<tr>
						<td><label for='OptionA1'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["strSurname"].":</label>$imgRequired</td>
						<td align='right'><input id='strSurname' class='controlText' type='text' value=\"$strSurname\" name='strSurname' ></td>
						<td align='right' width='50px'></td>
					</tr>
				</table>
				<div id='ErrorContent_strSurname' class='Error_Text'></div>

				<table width='100%'>
					<tr>
						<td><label for='strTel'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["strTel"].":</label>$imgRequired</td>
						<td align='right'>
							<input onchange='jsAreaCodeValid();' style='width:50px;' id='strAreaCode' class='controlText' type='text' value=\"$strAreaCode\" name='strAreaCode' > -
							<input onchange='jsTelValid();' style='width:171px;' id='strTel' class='controlText' type='text' value=\"$strTel\" name='strTel' >
						</td>
						<td align='right' width='50px'></td>
					</tr>
				</table>
				<div id='ErrorContent_strTel' class='Error_Text'></div>
				<div id='ErrorContent_strArea' class='Error_Text'></div>
				<table width='100%'>
					<tr>
						<td><label for='strCell'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["strCell"].":</label></td>
						<td align='right'><input onchange='jsCellValid();' id='strCell' class='controlText' type='text' value=\"$strCell\" name='strCell' />  </td>
						<td align='right' width='50px'></td>
					</tr>
				</table>
				<div id='ErrorContent_strCell' class='Error_Text'></div>
				<table width='100%'>
					<tr>
						<td><label for='strFax'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["strFax"].":</label></td>
						<td align='right'><input onchange='jsFaxValid();' id='strFax' class='controlText' type='text' value=\"$strFax\" name='strFax' />  </td>
						<td align='right' width='50px'></td>
					</tr>
				</table>
				<div id='ErrorContent_strFax' class='Error_Text'></div>
				<table width='100%'>
					<tr>
						<td><label for='strEmail'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["strEmail"].":</label>$imgRequired</td>
						<td align='right'><input onchange='jsEmailValid();' id='strEmail' class='controlText' type='text' value=\"$strEmail\" name='strEmail' />  </td>
						<td align='right' width='50px'></td>
					</tr>
				</table>
				<div id='ErrorContent_strEmail' class='Error_Text'></div>
				<table width='100%'>
					<tr>
						<td><label for='strWebsiteURL'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["strWebsiteURL"].":</label></td>
						<td align='right'><input id='strWebsiteURL' class='controlText' type='text' value=\"$strWebsiteURL\" name='strWebsiteURL' />  </td>
						<td align='right' width='50px'></td>
					</tr>
				</table>

				<table width='100%' style='margin-top:12px;' >
					<tr>
						<td><label for=''>".$_TRANSLATION[$_SESSION[LANGUAGE]]["Correspondence"].":</label>$imgRequired</td>
						<td align='right'>
							<select id='strCorrespondenceLanguage' name='strCorrespondenceLanguage' class='controlText'>
								<option value='0'> ". $_TRANSLATION[$_SESSION[LANGUAGE]]["optSelect"] ." </option>
								$ddlLanguage
							</select>
						</td>
						<td align='right' width='50px'> </td>
					</tr>
				</table>

				<div id='ErrorContent_strEmail' class='Error_Text'></div>
			</div>
			<input type='hidden' value='1' name='saveData' />";

		## JAVASCRIPT
		$JS = "  <script>

						function jsGetBusinessName()
						{
							strMember = $('#strMember').val();
							$.ajax(
							{
								type: 'POST',
								url: 'ajaxfunctions.php',
								data: 'header=text&type=GetBusinessName&strMember=' + strMember,
								success: function(data)
								{
									if(data == 1)
									{
										$('#ErrorContent_strMember').html(\"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strMember_exist"]."\")
										$('#ErrorContent_strMember').slideDown('fast');
										msg += \"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strMember_exist"]." \\n\"
									}
									else
									{
										$('#ErrorContent_strMember').slideUp('fast');
									}
								}
							});
						}

						function jsGetRegistrationNumber()
						{
							strRegistrationNumber = $('#strRegistrationNumber').val();
							$.ajax(
							{
								type: 'POST',
								url: 'ajaxfunctions.php',
								data: 'header=text&type=GetRegistrationNumber&strRegistrationNumber=' + strRegistrationNumber,
								success: function(data)
								{
									if(data == 1)
									{
										$('#ErrorContent_strRegistrationNumber').html(\"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strRegistrationNumber_exist"]."\")
										$('#ErrorContent_strRegistrationNumber').slideDown('fast');
										msg += \"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strRegistrationNumber_exist"]." \\n\"
									}
									else
									{
										$('#ErrorContent_strRegistrationNumber').slideUp('fast');
									}
								}
							});
						}

						function jsGetVATRegistrationNumber()
						{
							strVATRegistrationNumber = $('#strVATRegistrationNumber').val();
							$.ajax(
							{
								type: 'POST',
								url: 'ajaxfunctions.php',
								data: 'header=text&type=GetVATRegistrationNumber&strVATRegistrationNumber=' + strVATRegistrationNumber,
								success: function(data)
								{
									if(data == 1)
									{
										$('#ErrorContent_strVATRegistrationNumber').html(\"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strVATRegistrationNumber_exist"]."\")
										$('#ErrorContent_strVATRegistrationNumber').slideDown('fast');
										msg += \"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strVATRegistrationNumber_exist"]." \\n\"
									}
									else
									{
										$('#ErrorContent_strVATRegistrationNumber').slideUp('fast');
									}
								}
							});
						}

						function jsCopyAddress()
						{ 

							  PostalAddress = $('#txtPostalAddress').val();
							$('#txtPhysicalAddress').val(PostalAddress) 
						}

						function jsVatNumber()
						{
							if($('input[name=\"radVatNumber\"]:checked').val() == '1')
							{
								$('#strVatNumber').slideDown('fast');
							}
							else
							{
								$('#strVatNumber').slideUp('fast');
							}
						}

						function jsChangeRequired(idx)
						{
							legalEntityType = $('#strLegalEntityType').val();
							if((legalEntityType == 'Company') || (legalEntityType == 'Trust') || (legalEntityType == 'Closed Corporation'))
							{

								$('#'+idx).html('<b class=\"textColour\" style=\"font-size: 20px;\">*</b>')
							}
							else
							{
								$('#'+idx).html('');
							}
						}


						function jsTelValid()
					{
						$('#ErrorContent_strTel').slideUp('fast');

						if(($('#strTel').val() == '') || ($('#strTel').val() == ' '))
						{
							$('#ErrorContent_strTel').html(\"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strTel"]."\")
							$('#ErrorContent_strTel').slideDown('fast');
							msg += \"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strTel"]." \\n\"
						}
						else
						{
							var pattern = new RegExp(/[0-9 -()+]+$/);
							telVal = $('#strTel').val();
							verdict = pattern.test(telVal);

							if(verdict == false)
							{
								$('#ErrorContent_strTel').html(\"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strTel_Invalid"]."\")
								$('#ErrorContent_strTel').slideDown('fast');
								msg += \"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strTel_Invalid"]." \\n\"
							}
							else
							{
								if(telVal.length != 7)
								{
									$('#ErrorContent_strTel').html(\"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strTel_Invalid"]."\")
									$('#ErrorContent_strTel').slideDown('fast');
									msg += \"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strTel_Invalid"]." \\n\"
								}
							}
						}
					}

					function jsAreaCodeValid()
					{
						 $('#ErrorContent_strArea').slideUp('fast');

						if(($('#strAreaCode').val() == '') || ($('#strAreaCode').val() == ' '))
						{
							$('#ErrorContent_strArea').html(\"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strTel_Area"]."\")
							$('#ErrorContent_strArea').slideDown('fast');
							msg += \"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strTel_Area"]." \\n\"
						}
						else
						{

						  var AreaCode;

						  strAreaCode = $('#strAreaCode').val();

						  var AreaCodeNumOne = strAreaCode.substring(0,1);
						  var firstAreaCodeNum = isNaN(AreaCodeNumOne);

						  var AreaCodeNumTwo = strAreaCode.substring(1,2);
						  var secondAreaCodeNum = isNaN(AreaCodeNumTwo);

						  var AreaCodeNumThree = strAreaCode.substring(2,3);
						  var thirdAreaCodeNum = isNaN(AreaCodeNumThree);


						  if(firstAreaCodeNum == true || secondAreaCodeNum == true || thirdAreaCodeNum == true)
						  {
							 AreaCode = false; //One of the three characters is not numeric
						  }
						  else
							 if(firstAreaCodeNum == false && secondAreaCodeNum == false && thirdAreaCodeNum == false)
							 {
								AreaCode = true; // All of the charaters are numeric
							 }

							 if(strAreaCode.length != 3 || AreaCode == false)
								{
									$('#ErrorContent_strArea').html(\"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strTel_Area"]."\")
									$('#ErrorContent_strArea').slideDown('fast');
									msg += \"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strTel_Area"]." \\n\"
								}

						}
					}

					function jsCellValid()
					{
						$('#ErrorContent_strCell').slideUp('fast');

						if(($('#strCell').val() == '') || ($('#strCell').val() == ' '))
						{
						}
						else
						{

						  strCell = $('#strCell').val();

							var cellNumber = isNaN(strCell);

							if(strCell.length != 10  || cellNumber == true)
								{
									$('#ErrorContent_strCell').html(\"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strCell"]."\")
									$('#ErrorContent_strCell').slideDown('fast');
									msg += \"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strCell"]." \\n\"
								}
						}
					}

					function jsFaxValid()
					{
						$('#ErrorContent_strFax').slideUp('fast');

						if(($('#strFax').val() == '') || ($('#strFax').val() == ' '))
						{
						}
						else
						{
							strFax = $('#strFax').val();

							 var faxNumber = isNaN(strFax);

							if(strFax.length != 10 || faxNumber == true)
								{
									$('#ErrorContent_strFax').html(\"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strFax"]."\")
									$('#ErrorContent_strFax').slideDown('fast');
									msg += \"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strFax"]." \\n\"
								}
						}
					}

					function jsEmailValid()
					{
						$('#ErrorContent_strEmail').slideUp('fast');

						if(($('#strEmail').val() == '') || ($('#strEmail').val() == ' '))
							{
								$('#ErrorContent_strEmail').html(\"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strEmail"]."\")
								$('#ErrorContent_strEmail').slideDown('fast');
								msg += \"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strEmail"]." \\n\"
							}
							else
							{
								var pattern = new RegExp(/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/);
								emailVal = $('#strEmail').val();

								verdict = pattern.test(emailVal);
								if(verdict == false)
								{
									$('#ErrorContent_strEmail').html(\"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strEmail_Invalid"]."\")
									$('#ErrorContent_strEmail').slideDown('fast');
									msg += \"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strEmail_Invalid"]." \\n\"
								}
							}

					}

						// PAGE VALIDATION ///////////////////////////////////////////////////////////////////////
						function jsValidation()
						{
							$('.Error_Text').slideUp('fast');
							msg = '';

							if (!$('input[name=\"radVatNumber\"]:checked').length)
								{
									$('#ErrorContent_radVatNumber').html('".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_radVatNumber"]."')
									$('#ErrorContent_radVatNumber').slideDown('fast');
									msg += '".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_radVatNumber"]." \\n'
								}

							if(($('#strVATRegistrationNumber').val() == '') || ($('#strVATRegistrationNumber').val() == ' '))
							{
								strVATRegistrationNumber = $('#strVATRegistrationNumber').val();

								if($('input[name=\"radVatNumber\"]:checked').val() == 1)
								{
									$('#ErrorContent_strVATRegistrationNumber').html(\"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strVATRegistrationNumber"]."\")
									$('#ErrorContent_strVATRegistrationNumber').slideDown('fast');
									msg += \"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strVATRegistrationNumber"]." \\n\"
								}

							}

							if(($('#strMember').val() == '') || ($('#strMember').val() == ' '))
							{
								$('#ErrorContent_strMember').html(\"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strMember"]."\")
								$('#ErrorContent_strMember').slideDown('fast');
								msg += \"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strMember"]." \\n\"
							}

							if($('#strLegalEntityType').val() == 0)
							{
								$('#ErrorContent_strLegalEntityType').html(\"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strLegalEntityType"]."\")
								$('#ErrorContent_strLegalEntityType').slideDown('fast');
								msg += \"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strLegalEntityType"]." \\n\"
							}

							legalEntityType = $('#strLegalEntityType').val();
							if((legalEntityType == 'Company') || (legalEntityType == 'Trust') || (legalEntityType == 'Closed Corporation'))
							{
								if(($('#strRegistrationNumber').val() == '') || ($('#strRegistrationNumber').val() == ' '))
								{
									$('#ErrorContent_strRegistrationNumber').html(\"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strRegistrationNumber"]."\")
									$('#ErrorContent_strRegistrationNumber').slideDown('fast');
									msg += \"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strRegistrationNumber"]." \\n\"
								}
							}

							if(($('#txtPostalAddress').val() == '') || ($('#txtPostalAddress').val() == ' '))
							{
								$('#ErrorContent_txtPostalAddress').html(\"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_txtPostalAddress"]."\")
								$('#ErrorContent_txtPostalAddress').slideDown('fast');
								msg += \"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_txtPostalAddress"]." \\n\"
							}

							if(($('#txtPhysicalAddress').val() == '') || ($('#txtPhysicalAddress').val() == ' '))
							{
								$('#ErrorContent_txtPhysicalAddress').html(\"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_txtPhysicalAddress"]."\")
								$('#ErrorContent_txtPhysicalAddress').slideDown('fast');
								msg += \"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_txtPhysicalAddress"]." \\n\"
							}

							if(($('#strTitle').val() == '') || ($('#strTitle').val() == ' '))
							{
								$('#ErrorContent_strTitle').html(\"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strTitle"]."\")
								$('#ErrorContent_strTitle').slideDown('fast');
								msg += \"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strTitle"]." \\n\"
							}

							if(($('#strName').val() == '') || ($('#strName').val() == ' '))
							{
								$('#ErrorContent_strName').html(\"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strName"]."\")
								$('#ErrorContent_strName').slideDown('fast');
								msg += \"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strName"]." \\n\"
							}

							if(($('#strSurname').val() == '') || ($('#strSurname').val() == ' '))
							{
								$('#ErrorContent_strSurname').html(\"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strSurname"]."\")
								$('#ErrorContent_strSurname').slideDown('fast');
								msg += \"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strSurname"]." \\n\"
							}

							if(($('#strTel').val() == '') || ($('#strTel').val() == ' '))
							{
								$('#ErrorContent_strTel').html(\"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strTel"]."\")
								$('#ErrorContent_strTel').slideDown('fast');
								msg += \"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strTel"]." \\n\"
							}
							else
							{
								var pattern = new RegExp(/[0-9 -()+]+$/);
								telVal = $('#strTel').val();
								verdict = pattern.test(telVal);

								if(verdict == false)
								{
									$('#ErrorContent_strTel').html(\"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strTel_Invalid"]."\")
									$('#ErrorContent_strTel').slideDown('fast');
									msg += \"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strTel_Invalid"]." \\n\"
								}
								else
								{
									if(telVal.length != 7)
									{
										$('#ErrorContent_strTel').html(\"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strTel_Invalid"]."\")
										$('#ErrorContent_strTel').slideDown('fast');
										msg += \"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strTel_Invalid"]." \\n\"
									}
								}
							}

							if(($('#strAreaCode').val() == '') || ($('#strAreaCode').val() == ' '))
							{
								$('#ErrorContent_strArea').html(\"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strTel_Area"]."\")
								$('#ErrorContent_strArea').slideDown('fast');
								msg += \"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strTel_Area"]." \\n\"
							}
							else
							{
								var pattern = new RegExp(/[0-9 -()+]+$/);
								strAreaCode = $('#strAreaCode').val();
								verdict2 = pattern.test(strAreaCode);

								if(verdict2 == false)
								{
									$('#ErrorContent_strArea').html(\"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strTel_Area"]."\")
									$('#ErrorContent_strArea').slideDown('fast');
									msg += \"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strTel_Area"]." \\n\"
								}
								else
								{
									if(strAreaCode.length != 3)
									{
										$('#ErrorContent_strArea').html(\"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strTel_Area"]."\")
										$('#ErrorContent_strArea').slideDown('fast');
										msg += \"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strTel_Area"]." \\n\"
									}
								}
							}

							if(($('#strCell').val() == '') || ($('#strCell').val() == ' '))
							{
							}
							else
							{

							  strCell = $('#strCell').val();

								var cellNumber = isNaN(strCell);

								if(strCell.length != 10  || cellNumber == true)
								{
									$('#ErrorContent_strCell').html(\"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strCell"]."\")
									$('#ErrorContent_strCell').slideDown('fast');
									msg += \"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strCell"]." \\n\"
								}
							}

							if(($('#strFax').val() == '') || ($('#strFax').val() == ' '))
							{
							}
							else
							{
								strFax = $('#strFax').val();

								 var faxNumber = isNaN(strFax);

								if(strFax.length != 10 || faxNumber == true)
								{
									$('#ErrorContent_strFax').html(\"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strFax"]."\")
									$('#ErrorContent_strFax').slideDown('fast');
									msg += \"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strFax"]." \\n\"
								}
							}

							if(($('#strEmail').val() == '') || ($('#strEmail').val() == ' '))
							{
								$('#ErrorContent_strEmail').html(\"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strEmail"]."\")
								$('#ErrorContent_strEmail').slideDown('fast');
								msg += \"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strEmail"]." \\n\"
							}
							else
							{
								var pattern = new RegExp(/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/);
								emailVal = $('#strEmail').val();

								verdict = pattern.test(emailVal);
								if(verdict == false)
								{
									$('#ErrorContent_strEmail').html(\"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strEmail_Invalid"]."\")
									$('#ErrorContent_strEmail').slideDown('fast');
									msg += \"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strEmail_Invalid"]." \\n\"
								}
							}

							if(msg != '')
							{
								//alert(msg);
								return false;
							}
							return true;
						}
					</script>";

		## RETURN
		return $Content . $JS;
	}

	function getOwnerDetailsContent()
	{
		return "<input type='hidden' value='1' name='saveData' />some random content";
	}


	function getDocumentsContent()
	{
		## GLOBAL VARS
		global $xdb, $arrSys, $TR, $SP, $HR, $DATABASE_SETTINGS, $SystemSettings, $imgRequired, $_LANGUAGE,$_TRANSLATION ;

		$Documents_Table = "";
		$Documents_Counter = 0;

		$rstDocs = $xdb->doQuery("SELECT * FROM vieDocumentMember WHERE refMemberID = '". $_SESSION[S3REGISTRATION]->MemberID . "'");
		while($rowDocs = $xdb->fetch_object($rstDocs))
		{
			$Documents_Counter++;
			$Documents_Table .= "<tr>
											<td align='center'>$Documents_Counter</td>
											<td align='left'>$rowDocs->strFilename</td>
											<td align='left'></td>
											<td align='center'><img src='images/delete.png' width='20px' onclick='jsRemoveItem(this, $rowDocs->DocumentID);' /></td>
										</tr>";
		}

		## HTML CONTENT
		$Content = "<div>

							<table width='100%' style='margin-top:12px;'>
								<tr>
									<td><label for='OptionA1'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["TitleDocuments"].":</label> <br>
									".$_TRANSLATION[$_SESSION[LANGUAGE]]["FileTypes"]."
									<td align='right' colspan='2'>
										<input id='' class='controlButton' type='button' value='".$_TRANSLATION[$_SESSION[LANGUAGE]]["btnAdd"]."' onClick='jsAddItem();' name='btnAdd' />
									</td>
								</tr>
							</table>

							<table class='docTable' width='100%' style='margin-top:12px;' cellspacing='0' cellpadding='0' border='0'>
								<tr>
									<th width='20px' style='padding:4px 4px;' align='center'>#</th>
									<th width='250px' style='padding:4px 4px;' align='left'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["arrFileName"]."</th>
									<th width='20px' style='padding:4px 4px;' align='left'></th>
									<th width='20px' style='padding:4px 4px;' align='left'></th>
								</tr>
								<tr><td colspan='7'></td></tr>

								$Documents_Table

								<tr class='itemRow' id='extraRow' style='display:none;'>
									<td align='center'>+<input type='hidden' id='strID' /></td>
									<td align='left'><input type='file' onChange='' class='controlText' style='width:99%;' name='' id='strFile' accept='.jpg, .png, .pdf' /></td>
									<td align='left'></td>
									<td align='center'><img src='images/delete.png' width='20px' onclick='jsRemoveItem(this, 0);' /></td>
								</tr>

							</table>
							<div id='ErrorContent_AN' class='Error_Text'></div>
							<div id='ErrorFileSize_EN' class='Error_Text'></div>
							<div id='ErrorFileType_EN' class='Error_Text'></div>
						</div>
						<input type='hidden' value='1' name='saveData' /> ";


		## JAVASCRIPT
		$JS = "  <script>

					var uniqueID = -1;

					function jsCheckFile(inputId)
					{


						var uploadedFile = document.getElementById('strFile_' + inputId);
						var fileType = uploadedFile.files[0].type;
						var fileSize = uploadedFile.files[0].size;

						 if((fileType != 'application/pdf') && (fileType != 'image/png') && (fileType != 'image/jpeg'))
						 {
							  $('#ErrorFileType_EN').html(\"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strFileType_Invalid"]."\")
							  $('#ErrorFileType_EN').slideDown('fast');
							  msg = 'random'
						 }
						else
						  {
								$('#ErrorFileType_EN').slideUp('fast');
						  }

						  if(fileSize > 5500000)
						  {
							 $('#ErrorFileSize_EN').html(\"".$_TRANSLATION[$_SESSION[LANGUAGE]]["valid_strFileSize_Invalid"]."\")
							 $('#ErrorFileSize_EN').slideDown('fast');
							 msg = 'random'
						  }
						  else
						  {
								$('#ErrorFileSize_EN').slideUp('fast');
						  }

					}

					function jsAddItem()
					{
						var copy = $('#extraRow').clone(true).insertAfter('#extraRow');
						var trID = 'extraRow_'+ uniqueID;
						copy.attr('id', trID);

						$('#extraRow_'+uniqueID).find('#strID').each(function(){
							var Id = $(this).attr('id');
							$(this).attr('name', 'arrID['+uniqueID+']');
							$(this).attr('id', Id+'_'+uniqueID);
							$('#'+Id+'_'+uniqueID).val(uniqueID)
							$(this).addClass('strID');
						});

						$('#extraRow_'+uniqueID).find('#ddlType').each(function(){
							var Id = $(this).attr('id');
							$(this).attr('name', 'arr_ddlType['+uniqueID+']');
							$(this).attr('id', Id+'_'+uniqueID);
						});

						$('#extraRow_'+uniqueID).find('#strFile').each(function(){
							var Id = $(this).attr('id');
							$(this).attr('name', 'arr_strFile['+uniqueID+']');
							$(this).attr('id', Id+'_'+uniqueID);
							$(this).attr('onChange', 'jsCheckFile('+uniqueID+')');
						});

						$('#extraRow_'+uniqueID).find('#strUploadDate').each(function(){
							var Id = $(this).attr('id');
							$(this).attr('name', 'arr_strUploadDate['+uniqueID+']');
							$(this).attr('id', Id+'_'+uniqueID);
						});

						$('#extraRow_'+uniqueID).find('#chkRemove').each(function(){
							var Id = $(this).attr('id');
							$(this).attr('name', 'arr_chkRemove['+uniqueID+']');
							$(this).attr('id', Id+'_'+uniqueID);
							$(this).attr('class', 'chkRemove');
						});


						$('#extraRow_'+uniqueID).css('display','');
						uniqueID--
					}



					function test()
					{

					}

					function jsRemoveItem(DocRow, IDx)
					{
						if(IDx == 0)
						{
							$(DocRow).parent().parent().remove();
						}
						else
						{
							$.ajax(
							{
								type: 'POST',
								url: 'ajaxfunctions.php',
								data: 'header=text&type=DeleteDocument&DocumentID=' + IDx,
								success: function(data)
								{
									try {}
									catch(e) {}
									finally {}
								}
							});

							$(DocRow).parent().parent().remove();
						}

					}

					function jsValidation()
					{
						$('.Error_Text').slideUp('fast');
						msg = '';

						$('.docTable').find('.strID').each(function(){
							inputId = $(this).val()
							return jsCheckFile(inputId)
						});
			
						
						if(msg != '')
						{
							return false;
						}
						return true;
					}

					</script>";

		## SERIALISED ARRAY WITH ENTITY ID AND ENTITY TYPE :: JACQUES :: 30 OKT  
       
         $DocTitle = $_SESSION[S3REGISTRATION]->MemberID;
         $DocDecs = "MemberTMP";
    
      ## FILE UPLOAD WIDGET HTML
      $NewContent  = "  <link rel='stylesheet' href='js/jQuery-File-Upload-9.11.2/CUSTOM/bootstrap.css'>  
                        <link rel='stylesheet' href='http://blueimp.github.io/Gallery/css/blueimp-gallery.min.css'> 
                        <link rel='stylesheet' href='js/jQuery-File-Upload-9.11.2/css/jquery.fileupload.css'>
                        <link rel='stylesheet' href='js/jQuery-File-Upload-9.11.2/css/jquery.fileupload-ui.css'> 
                        <noscript><link rel='stylesheet' href='js/jQuery-File-Upload-9.11.2/css/jquery.fileupload-noscript.css'></noscript>
                        <noscript><link rel='stylesheet' href='js/jQuery-File-Upload-9.11.2/css/jquery.fileupload-ui-noscript.css'></noscript> 
                        
                        </form>
                        <form id='fileupload' action='https://jquery-file-upload.appspot.com/' method='POST' enctype='multipart/form-data'>
                           
                           <noscript><input type='hidden' name='redirect' value='https://blueimp.github.io/jQuery-File-Upload/''></noscript>
                            
                           <div class='row fileupload-buttonbar'>
                              <div class='col-lg-9' style='width:500'> 
                                 <span class='btn btn-success fileinput-button'>
                                    <i class='glyphicon glyphicon-plus'></i>
                                    <span>Add files...</span>
                                    <input type='file' name='files[]' multiple>
                                 </span>
                                 <button type='submit' class='btn btn-primary start'>
                                    <i class='glyphicon glyphicon-upload'></i>
                                    <span>Start upload</span>
                                 </button>
                                 <button type='reset' class='btn btn-warning cancel'>
                                    <i class='glyphicon glyphicon-ban-circle'></i>
                                    <span>Cancel upload</span>
                                 </button>
                                  
                              </div>

                              <div class='col-lg-12 fileupload-progress fade'>
                                 <div class='progress progress-striped active' role='progressbar' aria-valuemin='0' aria-valuemax='100'>
                                    <div class='progress-bar progress-bar-success' style='width:0%;''></div>
                                 </div>
                                 <div class='progress-extended'>&nbsp;</div>
                              </div>
                           </div> 
                           <table role='presentation' class='table table-striped'><tbody class='files'></tbody></table>
                        </form>
                        <form name='frmNemo' enctype='multipart/form-data' action='". $page->SystemSettings[FULL_PATH] ."' method='post'>
 
                        <script id='template-upload' type='text/x-tmpl'>
                        
                           {% for (var i=0, file; file=o.files[i]; i++) { %}

                              <tr class='template-upload fade'>
                                 <td width='15%'>
                                    <span class='preview'></span>
                                    <input type='hidden' name='title[]' value='$DocTitle' class='form-control'> 
                                    <input type='hidden' name='description[]' value='$DocDecs' class='form-control'> 
                                 </td>
                                 <td width='35%'>
                                    <p class='name'>{%=file.name%}</p>
                                    <strong class='error text-danger'></strong>
                                 </td>
                                 <td width='15%'>
                                    <p class='size'>Processing...</p>
                                    <div class='progress progress-striped active' role='progressbar' aria-valuemin='0' aria-valuemax='100' aria-valuenow='0'><div class='progress-bar progress-bar-success' style='width:0%;'></div></div>
                                 </td>
                                 <td width='35%' align='right'>
                                    {% if (!i && !o.options.autoUpload) { %}
                                        <button class='btn btn-primary start' disabled>
                                            <i class='glyphicon glyphicon-upload'></i>
                                            <span>Start</span>
                                        </button>
                                    {% } %}
                                    {% if (!i) { %}
                                        <button class='btn btn-warning cancel'>
                                            <i class='glyphicon glyphicon-ban-circle'></i>
                                            <span>Cancel</span>
                                        </button>
                                    {% } %}
                                 </td>
                              </tr>
                           {% } %}
                        
                        </script>

   
                        <script id='template-download' type='text/x-tmpl'>
                           {% for (var i=0, file; file=o.files[i]; i++) { %}
                              <tr class='template-download fade'>
                                 <td width='15%'>
                                    <span class='preview'>
                                       {% if (file.thumbnailUrl) { %}
                                          <a href='{%=file.url%}' title='{%=file.name%}' download='{%=file.name%}' data-gallery><img src='{%=file.thumbnailUrl%}'></a>
                                       {% } %}
                                    </span>
                                 </td>
                                 <td width='35%'>
                                    <p class='name'>
                                       {% if (file.url) { %}
                                          <a href='{%=file.url%}' title='{%=file.name%}' download='{%=file.name%}' {%=file.thumbnailUrl?'data-gallery':''%}>{%=file.name%}</a>
                                       {% } else { %}
                                          <span>{%=file.name%}</span>
                                       {% } %}
                                    </p>
                                    {% if (file.error) { %}
                                       <div><span class='label label-danger'>Error</span> {%=file.error%}</div>
                                    {% } %}
                                 </td>
                                 <td width='15%'>
                                    <span class='size'>{%=o.formatFileSize(file.size)%}</span>
                                 </td>
                                 <td width='35%' align='right'>
                                    {% if (file.deleteUrl) { %}
                                       <button class='btn btn-danger delete' data-type='{%=file.deleteType%}' data-url='{%=file.deleteUrl%}'{% if (file.deleteWithCredentials) { %} data-xhr-fields='{\"withCredentials\":true}'{% } %}>
                                          <i class='glyphicon glyphicon-trash'></i>
                                          <span>Delete</span>
                                       </button> 
                                    {% } else { %}
                                       <button class='btn btn-warning cancel'>
                                          <i class='glyphicon glyphicon-ban-circle'></i>
                                          <span>Cancel</span>
                                       </button>
                                    {% } %}
                                 </td>
                              </tr>
                           {% } %}
                        </script>
                        <script src='https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js'></script> 
                        <script src='js/jQuery-File-Upload-9.11.2/js/vendor/jquery.ui.widget.js'></script> 
                        <script src='http://blueimp.github.io/JavaScript-Templates/js/tmpl.min.js'></script> 
                        <script src='http://blueimp.github.io/JavaScript-Load-Image/js/load-image.all.min.js'></script> 
                        <script src='http://blueimp.github.io/JavaScript-Canvas-to-Blob/js/canvas-to-blob.min.js'></script> 
                        <script src='http://netdna.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js'></script> 
                        <script src='http://blueimp.github.io/Gallery/js/jquery.blueimp-gallery.min.js'></script>
 
                        <script src='js/jQuery-File-Upload-9.11.2/js/jquery.iframe-transport.js'></script> 
                        <script src='js/jQuery-File-Upload-9.11.2/js/jquery.fileupload.js'></script> 
                        <script src='js/jQuery-File-Upload-9.11.2/js/jquery.fileupload-process.js'></script> 
                        <script src='js/jQuery-File-Upload-9.11.2/js/jquery.fileupload-image.js'></script> 
                        <script src='js/jQuery-File-Upload-9.11.2/js/jquery.fileupload-audio.js'></script> 
                        <script src='js/jQuery-File-Upload-9.11.2/js/jquery.fileupload-video.js'></script> 
                        <script src='js/jQuery-File-Upload-9.11.2/js/jquery.fileupload-validate.js'></script> 
                        <script src='js/jQuery-File-Upload-9.11.2/js/jquery.fileupload-ui.js'></script> 
                        <script src='js/jQuery-File-Upload-9.11.2/js/main.js'></script>";  
      $rstDocs = $xdb->doQuery("SELECT * FROM tblDocument WHERE refEntityID = '".$_SESSION[S3REGISTRATION]->MemberID."' AND EntityType = 'MemberTMP'");
      while($rowDocs = $xdb->fetch_object($rstDocs))
      {	

      	if($rowDocs->type == "application/pdf")
         {
            $thumbnail = "<img height='60px' src='images/pdf_icon.png'>";
         }
         else if($rowDocs->type == "image/tiff")
         {
         	$thumbnail = "<img height='60px' src='images/tiff_icon.png'>";
         }
         else
         {  
            $thumbnail = "<img src='js/jQuery-File-Upload-9.11.2/server/php/files/2thumbnail/$rowDocs->strFilename'>";
         }
         $rowDocs->size = round($rowDocs->size/1024, 2);
         $CurrentContent .= " <tr class='template-download'>
                                 <td width='15%' style='padding: 8px; border-top: 1px solid #ddd;background-color: #f9f9f9;'><span class='preview'> <a href='#' title='' download=''>$thumbnail </a></span></td>
                                 <td width='35%' style='padding: 8px; border-top: 1px solid #ddd;background-color: #f9f9f9;'><p class='name'> <span>$rowDocs->strFilename</span> </p></td>
                                 <td width='15%' style='padding: 8px; border-top: 1px solid #ddd;background-color: #f9f9f9;'><span class='size'>$rowDocs->intSize</span> </td>
                                 <td align='right' width='35%' style='padding: 8px; border-top: 1px solid #ddd;background-color: #f9f9f9;'> 
                                    <div class='btn btn-danger delete' onClick='jsRemoveFile(this,$rowDocs->DocumentID);' > <i class='glyphicon glyphicon-trash'></i> <span>Delete</span> </div> 
                                 </td>
                              </tr> ";
      }
      
      $JS = "  <script>
               function jsRemoveFile(ctrl, idx)
               {      
                  $(ctrl).parent().parent().hide('slow');
                  
                  $.ajax(
                  {
                     type: 'POST',
                     url: 'ajaxfunctions.php',
                     data: 'header=text&type=removeFile&DocID=' + idx,
                     success: function(data)
                     { 
                       $(ctrl).parent().parent().remove();
                     }
                  });
               }
               </script>";
      return $NewContent . "<table width='100%'>" . $CurrentContent . "</table><input type='hidden' value='1' name='saveData' /> " . $JS;
	}

	function getReviewContent()
	{
		global $xdb, $arrSys, $BR, $TR, $SP, $HR, $DATABASE_SETTINGS, $SystemSettings, $_TRANSLATION;

//INI
		$iconWrong = "<img src='images/wrong_icon.png' />";
		$iconCorrect = "<img src='images/icon-correct.png' />";
		$strSettingLanguage = "strSetting:Language";

//LOAD
		$DoneMT = $iconWrong;
		$DoneUD = $iconWrong;
		$DoneMD = $iconWrong;
		$DoneD = $iconWrong;

		## GET TEMP MEMBER DETAILS

		$rowUser = $xdb->getRowSQL("SELECT sysUser.*
			FROM sysUser LEFT JOIN tmpMember ON sysUser.refMemberID = tmpMember.MemberID
			WHERE refMemberID = '".$_SESSION[S3REGISTRATION]->MemberID ."'");

		$rowMember = $xdb->getRowSQL("SELECT *
			FROM tmpMember LEFT JOIN tblMemberType ON tmpMember.refMemberTypeID = tblMemberType.MemberTypeID
			WHERE MemberID = '".$_SESSION[S3REGISTRATION]->MemberID ."'");


		## CHECK IF EACH SECTION IS COMPLETE
		$arrStatus = str_split($rowMember->RegistrationStatus);
		if($rowMember->RegistrationStatus >= 11110)
			$blnRegistrationStatus = "true";
		else
			$blnRegistrationStatus = "false";

		if($arrStatus[2] == 1)
		{
			$DoneMT = $iconCorrect;
		}else{
			$strRegistrationMessage .= $_TRANSLATION[$_SESSION[LANGUAGE]]["valMT"];
		} 
		if($arrStatus[0] == 1)
		{
			$DoneUD = $iconCorrect;
		}else{
			$strRegistrationMessage .= $_TRANSLATION[$_SESSION[LANGUAGE]]["valUD"];
		}

		if($arrStatus[3] == 1)
		{
			$DoneMD = $iconCorrect;
		}else{
			$strRegistrationMessage .= $_TRANSLATION[$_SESSION[LANGUAGE]]["valMD"];
		}

		if($arrStatus[4] == 1)
		{
			$DoneD = $iconCorrect;
		}else{
			$DoneD = $iconCorrect;
		}


		//vd($rowMember->RegistrationArgs);
		$Args = unserialize($rowMember->RegistrationArgs);
		//vd($Args);

		if($Args["bMemberID"])
		{
			$rowB = $xdb->getRowSQL("SELECT strMember FROM tmpMember WHERE MemberID = '". $Args["bMemberID"] ."'");
			$trbMemberID = "
						<tr>
							<td style='padding-left:0px;'>". $_TRANSLATION[$_SESSION[LANGUAGE]]["MemberFacility"] ." :</td>
							<td>". $Args["bMemberID"] ." - $rowB->strMember</td>
						</tr>";
			$rowMember->strSARSPackhouseNumber = "<i>n/a</i>";
		}



		$rstDocs = $xdb->doQuery("SELECT * FROM tblDocument
			WHERE refEntityID = '".$_SESSION[S3REGISTRATION]->MemberID ."' AND EntityType = 'MemberTMP'
			ORDER BY strFilename",0);

		while($rowDoc = $xdb->fetch())
		{
			$trDocuments .="
				<tr>
					<td>$rowDoc->strFilename</td>
				</tr>";
		}
		if($Args["blnGrapeProducer"] == 'D')
		{
			$FarmSection = "
				<div class='reviewSection'>
					<h6 class='SectionHeader'>
						".$_TRANSLATION[$_SESSION[LANGUAGE]]["F_Heading"]."
						<img src='images/wrong_icon.png' />
					</h6>
					<table class='SectionList'>
						<col width='500px'>
						<col width=''>
						<tr>
							<td colspan='2' style='padding-left:0px;'><i>". $_TRANSLATION[$_SESSION[LANGUAGE]]["blnFarmNotice"] ."</i></td>
						</tr>
					</table>
				</div>";
		}

		## CREATE HTML
		$strContent = "
			<div class='reviewWrapper'>
				<div class='reviewSection'>
					<h6 class='SectionHeader'>
						<a href='registration.member.php?Step=1'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["MT_Heading"]."</a>
						$DoneMT
					</h6>
					<table class='SectionList'>
						<col width='250px'>
						<col width=''>
						<tr>
							<td style='padding-left:0px;'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["TypeOfMembership"]." :</td>
							<td>$rowMember->strMemberType</td>
						</tr>
						$trbMemberID
						<tr>
							<td style='padding-left:0px;'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["PackhouseNumber"]." :</td>
							<td>$rowMember->strSARSPackhouseNumber</td>
						</tr>
					</table>
				</div>

				<div class='reviewSection'>
					<h6 class='SectionHeader'>
						<a href='registration.member.php?Step=2'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["UD_Heading"]."</a>
						$DoneUD
					</h6>
					<table class='SectionList'>
						<col width='250px'>
						<col width=''>
						<tr>
							<td style='padding-left:0px;'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["strTitle"]." :</td>
							<td>$rowUser->strTitle</td>
						</tr
						<tr>
							<td style='padding-left:0px;'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["strName"]." :</td>
							<td>$rowUser->strName</td>
						</tr>
						<tr>
							<td style='padding-left:0px;'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["strSurname"]." :</td>
							<td>$rowUser->strSurname</td>
						</tr>
						<tr>
							<td style='padding-left:0px;'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["strTel"]." :</td>
							<td>$rowUser->strTel</td>
						</tr>
						<tr>
							<td style='padding-left:0px;'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["strCell"]." :</td>
							<td>$rowUser->strCell</td>
						</tr>
						<tr>
							<td style='padding-left:0px;'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["strFax"]." :</td>
							<td>$rowUser->strFax</td>
						</tr>
						<tr>
							<td style='padding-left:0px;'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["strEmail"]." :</td>
							<td>$rowUser->strEmail</td>
						</tr>
						<tr>
							<td style='padding-left:0px;'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["strLanguage"]." :</td>
							<td>". $rowUser->$strSettingLanguage ."</td>
						</tr>
					</table>
				</div>

				<div class='reviewSection'>
					<h6 class='SectionHeader'>
						<a href='registration.member.php?Step=3'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["MD_Heading"]."</a>
						$DoneMD
					</h6>
					<table class='SectionList'>
						<col width='250px'>
						<col width=''>

						<tr>
							<td style='padding-left:0px;'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["strMember"]." :</td>
							<td>$rowMember->strMember</td>
						</tr>
						<tr>
							<td style='padding-left:0px;'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["strLegalEntityType"]." :</td>
							<td>$rowMember->strLegalEntityType</td>
						</tr>
						<tr>
							<td style='padding-left:0px;'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["strRegistrationNumber"]." :</td>
							<td>$rowMember->strRegistrationNumber</td>
						</tr>
						<tr>
							<td style='padding-left:0px;'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["strVATRegistrationNumber"]." :</td>
							<td>$rowMember->strVATRegistrationNumber</td>
						</tr>
						<tr>
							<td style='padding-left:0px;'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["txtPostalAddress"]." :</td>
							<td>$rowMember->txtPostalAddress</td>
						</tr>
						<tr>
							<td style='padding-left:0px;'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["txtPhysicalAddress"]." :</td>
							<td>$rowMember->txtPhysicalAddress</td>
						</tr>
						<tr>
							<td style='padding-left:0px;'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["strTitle"]." :</td>
							<td>$rowMember->strTitle</td>
						</tr
						<tr>
							<td style='padding-left:0px;'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["strName"]." :</td>
							<td>$rowMember->strName</td>
						</tr>
						<tr>
							<td style='padding-left:0px;'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["strSurname"]." :</td>
							<td>$rowMember->strSurname</td>
						</tr>
						<tr>
							<td style='padding-left:0px;'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["strTel"]." :</td>
							<td>$rowMember->strTel</td>
						</tr>
						<tr>
							<td style='padding-left:0px;'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["strCell"]." :</td>
							<td>$rowMember->strCell</td>
						</tr>
						<tr>
							<td style='padding-left:0px;'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["strFax"]." :</td>
							<td>$rowMember->strFax</td>
						</tr>
						<tr>
							<td style='padding-left:0px;'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["strEmail"]." :</td>
							<td>$rowMember->strEmail</td>
						</tr>
						<tr>
							<td style='padding-left:0px;'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["strWebsiteURL"]." :</td>
							<td>$rowMember->strWebsiteURL</td>
						</tr>

					</table>
				</div>
				<div class='reviewSection'>
					<h6 class='SectionHeader'>
						<a href='registration.member.php?Step=4'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["D_Heading"]."</a>
						$DoneD
					</h6>
					<table class='SectionList'>
						<col width='250px'>
						<col width=''>
						".$_TRANSLATION[$_SESSION[LANGUAGE]]["TR_TH_DocumentList"]."
						$trDocuments
					</table> $BR
				</div>

				$FarmSection

				<div class='reviewSection'>
					<h6 class='SectionHeader'>
						<a href='registration.member.php?Step=5'>".$_TRANSLATION[$_SESSION[LANGUAGE]]["N_Heading"]."</a>
					</h6>

					<textarea class='controlText' style='width:770px;' name='txtRegistrationNotes'></textarea>
					$BR$BR
					<input type='checkbox' name='chkTC' id='chkTC' /> <label for='chkTC'>". $_TRANSLATION[$_SESSION[LANGUAGE]]["T&C"] ."</label>
				</div>

			</div>"
			.js("
				// PAGE VALIDATION ///////////////////////////////////////////////////////////////////////

				function jsValidationSubmit()
				{

					//$('.Error_Text').slideUp('fast');
					msg = '';

					if(!$blnRegistrationStatus)
					{
						msg += '$strRegistrationMessage';
					}

					if(!$('#chkTC').is(':checked'))
					{
						msg += '". $_TRANSLATION["EN"]["valTC"] ."';
					}

					if(msg != '')
					{
msg += '\\n\\n TESTING ONLY - Do you want to submit your Application?'
						//alert(msg);
						return confirm(msg);
						//return false;
					}else{
						return true;
					}

				}

				");

		return $strContent;
	}

	function GetCompletedContent()
	{
		global $xdb, $arrSys, $TR, $SP, $HR, $DATABASE_SETTINGS, $SystemSettings, $_TRANSLATION;

		## GET CURRENT ARGUMENTS ARRAY
		$row = $xdb->getRowSQL("SELECT * FROM tmpMember WHERE MemberID = '". $_SESSION[S3REGISTRATION]->MemberID. "'");
		$Args = unserialize($row->RegistrationArgs);

		$Content .= $_TRANSLATION[$_SESSION[LANGUAGE]]["LoginSAWIS"];

		if($Args["blnGrapeProducer"] == "D")
		{
			$Content = $_TRANSLATION[$_SESSION[LANGUAGE]]["ContinueSAWIS2"] . "<input type='submit' name='Action' class='controlButton' style='margin-left:20px; width:auto; ' value='".$_TRANSLATION[$_SESSION[LANGUAGE]]["btnContinueSawis2"]."' />";
		}


		return $Content;
	}


	function GetCompletedContentLinked($blnNewUserExistingMemberContinue, $type="ConfirmationSend")
	{
		global $xdb, $arrSys, $TR, $SP, $HR, $DATABASE_SETTINGS, $SystemSettings, $_TRANSLATION;

		## GET CURRENT ARGUMENTS ARRAY
		//$row = $xdb->getRowSQL("SELECT * FROM tblMember WHERE MemberID = '". $_SESSION[S3REGISTRATION]->MemberID. "'");
		//$Args = unserialize($row->RegistrationArgs);


		$Content = "<a href='index.php'>Login to SAWIS</a>";
		return $Content;
	}

	function Submit($UserID, $MemberID)
	{
		//vd($_SESSION[S3REGISTRATION]);exit;

		global $xdb, $arrSys, $TR, $SP, $HR, $DATABASE_SETTINGS, $SystemSettings, $DT;

		//update txtRegNotes, strStatus = 1.2 Final Submission.
		$xdb->doQuery("UPDATE tmpMember
			SET strStatus = '1.2 - Final Submission', txtRegistrationNotes = ". $xdb->qs($_POST[txtRegistrationNotes]) ."
			WHERE MemberID = '$MemberID'",0); 

		unset($rowUser);
		$rowUser = $xdb->getRowSQL("  
			SELECT sysUser.*, tmpMember.strEmail as strEmailCC, tmpMember.strMember, vieMemberType_EN.strCategoryMemberType, vieMemberType_EN.strMemberTypeCode, tmpMember.RegistrationArgs
			FROM (sysUser INNER JOIN tmpMember ON sysUser.refMemberID = tmpMember.MemberID) INNER JOIN vieMemberType_EN ON tmpMember.refMemberTypeID = vieMemberType_EN.MemberTypeID
			WHERE UserID = '$UserID'",0);
		
		$strLanguage = "strSetting:Language"; $strLanguage = strtoupper(substr($rowUser->$strLanguage,0,2)); //vd($strLanguage); die;
		
		// $rowUser = $xdb->getRowSQL("SELECT sysUser.*, tblMember.strEmail as strEmailCC, tblMember.strMember, vieMemberType_EN.strCategoryMemberType, vieMemberType_EN.strMemberTypeCode, tblMember.RegistrationArgs
		//    FROM vieMemberType_EN INNER JOIN (sysUser INNER JOIN tblMember ON sysUser.refMemberID = tblMember.MemberID) ON vieMemberType_EN.MemberTypeID = tblMember.refMemberTypeID
		//    WHERE refMemberID = '$MemberID'",0);
	  // print_rr($rowUser);
		$Args = unserialize($rowUser->RegistrationArgs);
		if($rowUser->strMemberTypeCode == "CER000" || $rowUser->strMemberTypeCode == "CERPVT")
		{//die("20151019 - CHECKED - pj");
			$xdb->doQuery("INSERT IGNORE INTO tmpMemberRelationship (strType, refMemberID, refEntityID, refMemberTypeID, strApprovedBy, dtApproved, strLastUser)
				VALUES ('Member to Member', '$MemberID', '". $Args[bMemberID] ."', '12', '', NULL, 'S3 Registration')",0); //12 = CERPVT
		}

		
	//send user ticket
		$nemoEmail = new NemoEmail($rowUser->strEmail, "" , 0);
		$nemoEmail->LoadEmailTemplate("Ticket New Member $strLanguage");

		$arrValues[DisplayName] = $rowUser->strName;
		$url = $SystemSettings[BASE_URL]."/ticket.php?Type=SAWIS3&MemberID=$MemberID&UserID=$UserID";
		$arrValues[URL] = "<a href='$url'>$url</a>";

		$nemoEmail->Substitute($arrValues);

		$nemoEmail->addHeader("FROM", $SystemSettings["SMTP Send As"]);
		$nemoEmail->From = $SystemSettings["SMTP Send As"];
		$nemoEmail->addHeader("BCC", $SystemSettings["SMTP BCC"]);
		$nemoEmail->Bcc = $SystemSettings["SMTP BCC"];
		$nemoEmail->addHeader("CC", $row->strEmailCC);
		$nemoEmail->Cc = $row->strEmailCC;

//print_rr($nemoEmail);
		$nemoEmail->Send();
		unset($nemoEmail);


	//send admin S3 notice		
		$nemoEmail = new NemoEmail($SystemSettings["Email S3 Applications To"], "" , 0);
		$nemoEmail->LoadEmailTemplate("Notice New Member EN"); //. $_SESSION[LANGUAGE]

		$arrValues[DisplayName] = "Admin";
		$arrValues[MemberNumber] = $MemberID;
		$arrValues[MemberName] = $rowUser->strMember;
		$arrValues[MemberType] = "$rowUser->strMemberTypeCode - $rowUser->strCategoryMemberType";
		$url = $SystemSettings[BASE_URL]."/member.pending.php?MemberID=$MemberID&Action=Edit";
		$arrValues[URL] = "<a href='$url'>$url</a>";

		$nemoEmail->Substitute($arrValues);

		$nemoEmail->addHeader("FROM", $SystemSettings["SMTP Send As"]);
		$nemoEmail->From = $SystemSettings["SMTP Send As"];
		$nemoEmail->addHeader("BCC", $SystemSettings["SMTP BCC"]);
		$nemoEmail->Bcc = $SystemSettings["SMTP BCC"];

//print_rr($nemoEmail); die("sdjfbsbd");
		$nemoEmail->Send();
		unset($nemoEmail);

		if($_SESSION[S3REGISTRATION]->blnGrapeProducer != null)
		{//die("20151019 - CHECKED - pj");
		   unset($_SESSION[WizzardStep]);
		   unset($_SESSION[S3REGISTRATION]);
		   windowLocation("index.php?Action=Login&Nav=SAWIS2&strUsername=$rowUser->strEmail&strPasswordMD5=$rowUser->strPasswordMD5");
		   die;
		}
		else
		{//die("20151019 - CHECKED - pj");
		   windowLocation("registration.member.php?Step=7");
		   die;
		} 
	}

	function SubmitLink($UserID, $MemberID)
	{

		global $xdb, $arrSys, $TR, $SP, $HR, $DATABASE_SETTINGS, $SystemSettings, $DT,$_TRANSLATION;

		include_once("_framework/_nemo.email.cls.php");

		## CHECK IF MEMBER HAS SUPER USER in tblMember
		$rowMember = $xdb->getRowSQL("SELECT sysUser.*, tblMember.strEmail as strEmailCC 
				FROM sysUser INNER JOIN tblMember ON MemberID = refMemberID 
				WHERE refMemberID = '$MemberID'",0); 
	
		if(isset($rowMember))
		{ 
			$rowApplicant = $xdb->getRowSQL("SELECT * FROM sysUser WHERE UserID = $UserID",0); //die;
			$lang = "strSetting:Language"; $lang = strtoupper(substr($rowMember->$lang,0,2)); //vd($lang); die;

			## IF MEMBER HAS SUPER USER  SEND CONFIRMATION OF LINKING TO THE USER
			//print_rr($UserID);
			$nemoEmail = new NemoEmail($rowMember->strEmail, "" , 0);
			
			$nemoEmail->LoadEmailTemplate("Member Link Confirmation $lang");

			$arrValues[DisplayName] = $rowMember->strName; 
			$arrValues[Username] = $rowApplicant->strUser;
			$arrValues[UserEmail] = $rowApplicant->strEmail;

			$nemoEmail->Substitute($arrValues);

			$nemoEmail->addHeader("FROM", $SystemSettings["SMTP Send As"]);
			$nemoEmail->From = $SystemSettings["SMTP Send As"];
			$nemoEmail->addHeader("BCC", $SystemSettings["SMTP BCC"]);
			$nemoEmail->Bcc = $SystemSettings["SMTP BCC"];
			$nemoEmail->addHeader("CC", $row->strEmailCC);
			$nemoEmail->Cc = $row->strEmailCC; 

			//print_rr($nemoEmail);die();
			$nemoEmail->Send();
			
			## IF MEMBER HAS SUPER USER, MAKE THIS USER normal User
			$xdb->doQuery("UPDATE sysUser SET 
				refMemberID = $MemberID
				, refSecurityGroupID = 12 
				, blnActive = 0
				WHERE UserID = $UserID",0); //die("20151019 - CHECKED - pj");

			//windowLocation("registration.member.php?Step=7&type=ConfirmationSend"); //move to controller
		}
		else
		{
			## IF MEMBER HAS NO SUPER USER, MAKE THIS USER the MEMBER SUPERUSER UNAPPROVED. must be SG13 DO NO FL:SAJdLBF change
			$xdb->doQuery("UPDATE sysUser SET 
				refMemberID = $MemberID
				, refSecurityGroupID = 13 
				WHERE UserID = $UserID",0); //die("20151019 - CHECKED - pj");
			//windowLocation("registration.member.php?Step=7&type=NewSuperUserAssigned");
		}
	}

## SAVE FUNCTION #######################################################################################################################################################################

	function Save($UserID, $MemberID, $step)
	{

		global $xdb, $arrSys, $TR, $SP, $HR, $DATABASE_SETTINGS, $SystemSettings, $DT,$_TRANSLATION;
		## INI

		$dbUser = new NemoDatabase("sysUser", $UserID, null, 0);
		$dbMember = new NemoDatabase("tmpMember", $MemberID, null, 0);

		## REMOVE REGARGS FROM DB OBJECT ELSE RESAVING A SERIALIZED VALUE
		foreach ($dbMember->FieldList as $i => $field)
		{
			if($field->name == "RegistrationArgs")
			{
				unset($dbMember->FieldList[$i], $dbMember->Fields["RegistrationArgs"]);
				break;
			}
		}
		//echo "step ". $step;exit;
			
		## PROCESS NAME
		$strProcessName = "S3 Registration";
		switch ($step)
		{
			## SAVE USER DETAILS IN DATABASE
			case "1":
				## SET FIELDS THAT NeedS TO SAVE IN USER TABLE
				$dbUser->Fields["refSecurityGroupID"] = 13; //Member UNAPPROVED SuperUser
				$dbUser->Fields["strTitle"] = $_POST["strTitle"];
				$dbUser->Fields["strName"] = $_POST["strName"];
				$dbUser->Fields["strSurname"] = $_POST["strSurname"];
				$dbUser->Fields["strUser"] = $_POST["strSurname"] .", ". $_POST["strName"];
				$dbUser->Fields["strTel"] =  $_POST["strAreaCode"] ."-". $_POST["strTel"];
				$dbUser->Fields["strCell"] = $_POST["strCell"];
				$dbUser->Fields["strFax"] = $_POST["strFax"];
				$dbUser->Fields["strEmail"] = $_POST["strEmail"];
				$dbUser->Fields["Profile:PicturePath"] = "blank.jpg";
				$dbUser->Fields["strSetting:Language"] = $_POST["strLanguage"];
				$dbUser->Fields["dtFirstEdit"] = $DT;
				$dbUser->Fields["blnActive"] = 1;
				$dbUser->Fields["strFirstUser"] =
				$dbUser->Fields["strLastUser"] = $strProcessName;

				## IF PASSWORD IS NOT EMPTY UPDATE ELSE DONT UPDATE
				if($_POST["strPassword"] != "")
				{
					$dbUser->Fields["strPasswordMD5"] = md5($_POST["strPassword"]);
				}

				$result = $dbUser->Save(0,0);

				## GET USER ID THAT WAS CREATED
				//print_rr($UserID);die();
				if($UserID == 0)
				{
					//print_rr($_POST["strEmail"]);
					## IF IT WAS AN INCLUDE AND NOT AN UPDATE SEND REGISTRATION EMAIL
					include_once("_framework/_nemo.email.cls.php");

					$dbUser->ID[0] =
					$dbUser->Fields["UserID"] =
					$UserID = $dbUser->ID["UserID"];

					## SENED USER LOGIN MAIL
					$nemoEmail = new NemoEmail($_POST["strEmail"] , "" , 0);
					$nemoEmail->LoadEmailTemplate("New User Login Details ". strtoupper(substr($_POST["strLanguage"],0,2)));

					## SET SUBSTITUTIONS
					$arrValues[DisplayName] = $_POST["strName"];
					$arrValues[Username] = $_POST["strEmail"];
					$arrValues[Password] = $_POST["strPassword"];
					$arrValues[LOGIN_URL] = "<a href='".$SystemSettings[BASE_URL]."/index.php?username=". $_POST["strEmail"] ."'>www.SawisOnline.co.za</a>";

					$nemoEmail->Substitute($arrValues);

					## ADD EMAIL BSS AND SENDING INFO
					$nemoEmail->addHeader("FROM", $SystemSettings["SMTP Send As"]);
					$nemoEmail->addHeader("BCC", $SystemSettings["SMTP BCC"]);
					$nemoEmail->Bcc = $SystemSettings["SMTP BCC"];
					$nemoEmail->From = $SystemSettings["SMTP Send As"];

					## SEND
					//print_rr($nemoEmail);die();
					$nemoEmail->Send();
					unset($nemoEmail);
				}
				$_SESSION[S3REGISTRATION]->UserID = $UserID;

				break;

			## STORE USER TYPE IN SESSION
			case "2":
				$_SESSION[Wizzard]->ActiveParent = $_POST[chkUserType];

//TODO
				//if new user/member: continue

				//if new user/existing member
					//check if target member has superuser
						//send New User email to Superuser, cc Member // low priority
						//process ends
						//return false
					//else
						//set user.refMemberID = target Member.MemberID
						//Active = 0
						//Usergroup = 12



				break;

			## SAVE MEMBERSHIP TYPE IN DATABASE
			case "3":
				 
					if($_POST[refMembershipType] == 64)
					{
						$_POST[refMembershipType] = 9; //CELPVD = CELPVT + Farm
						$_POST[blnGrapeProducer] = "D";
					}
					if($_POST[refMembershipType] == "D")
					{
						$_POST[refMembershipType] = 15; //D = FRM000
						$_POST[blnGrapeProducer] = "D";
					}

					## IF MEMBER ID IS NOT SET STORE VALUES IN SESSION UNTIL NEXT SAVE ELSE SAVE IN DATABASE
					if(!isset($MemberID))
					{

						$_SESSION[S3REGISTRATION]->refMembershipType = $_POST[refMembershipType];
						$_SESSION[S3REGISTRATION]->strSARSPackhouseNumber = $_POST[strSARSPackhouseNumber];
						$_SESSION[S3REGISTRATION]->blnGrapeProducer = $_POST[blnGrapeProducer];
						$_SESSION[S3REGISTRATION]->bMemberID = qs($_POST[bMemberID]);
						$_SESSION[S3REGISTRATION]->SaveMembership = "1";
					}
					else
					{						
						
						## GET CURRENT ARGUMENTS ARRAY
						$row = $xdb->getRowSQL("SELECT * FROM tmpMember WHERE MemberID = '$MemberID'");
						$Args = unserialize($row->RegistrationArgs);

						$Args["blnGrapeProducer"] = $_POST[blnGrapeProducer];
						$Args["bMemberID"] = $_POST[bMemberID];

						$dbMember->Fields["refInspectorID"] = "NULL";
						$dbMember->Fields["refMemberTypeID"] = $_POST[refMembershipType];
						$dbMember->Fields["strSARSPackhouseNumber"] = $_POST[strSARSPackhouseNumber];

						## SAVE TO TBLMEMBER IN DATABASE
						$result = $dbMember->Save(0,0);

						## SEPERATE UPDATE FOR ARGUMANTS
						$xdb->doQuery("UPDATE tmpMember SET RegistrationArgs = '". serialize($Args) ."' WHERE MemberID = '$MemberID'",0);
					} 
				
				break;

			## SAVE MEMBERSHIP DETAILS IN DATABASE
			case "4":

				## SET FIELDS THAT NeedS TO SAVE IN USER TABLE
				$dbMember->Fields["refInspectorID"] = "NULL";
				$dbMember->Fields["strMember"] = $_POST["strMember"];
				$dbMember->Fields["strLegalEntityType"] = $_POST["strLegalEntityType"];
				$dbMember->Fields["strRegistrationNumber"] = $_POST["strRegistrationNumber"];
				$dbMember->Fields["strVATRegistrationNumber"] = $_POST["strVATRegistrationNumber"];
				$dbMember->Fields["txtPostalAddress"] = $_POST["txtPostalAddress"];
				$dbMember->Fields["txtPhysicalAddress"] = $_POST["txtPhysicalAddress"];
				$dbMember->Fields["strTitle"] = $_POST["strTitle"];
				$dbMember->Fields["strName"] = $_POST["strName"];
				$dbMember->Fields["strSurname"] = $_POST["strSurname"];
				$dbMember->Fields["strTel"] = $_POST["strAreaCode"] ."-". $_POST["strTel"];
				$dbMember->Fields["strCell"] = $_POST["strCell"];
				$dbMember->Fields["strFax"] = $_POST["strFax"];
				$dbMember->Fields["strEmail"] = $_POST["strEmail"];
				$dbMember->Fields["strWebsiteURL"] = $_POST["strWebsiteURL"];
				$dbMember->Fields["strSetting:CorrespondenceLanguage"] = $_POST["strCorrespondenceLanguage"];
				$dbMember->Fields["RegistrationStatus"] = 11100;
				$dbMember->Fields["dtFirstEdit"] =
				$dbMember->Fields["dtRegistration"] = $DT;
				$dbMember->Fields["strFirstUser"] =
				$dbMember->Fields["strLastUser"] = $strProcessName;
				$dbMember->Fields["strStatus"] = "1.0 - New";

				$row = $xdb->getRowSQL("SELECT * FROM tmpMember WHERE MemberID = '$MemberID'");

				if($row->RegistrationArgs != "")
				{
					$Args = unserialize($row->RegistrationArgs);
				}

				## CHECK IF MEMBERSHIP DETAILS ARE IN THE SESSION, IF SO SAVE THEM AND CLEAR THE SESSION
				if($_SESSION[S3REGISTRATION]->SaveMembership == "1")
				{
					## GET CURRENT ARGUMENTS ARRAY
					$row = $xdb->getRowSQL("SELECT * FROM tmpMember WHERE MemberID = '$MemberID'");

					if($row->RegistrationArgs == "")
					{
					}
					else
					{
						$Args = unserialize($row->RegistrationArgs);
					}

					$Args = unserialize($dbMember->Fields["RegistrationArgs"]);

					$Args["blnGrapeProducer"] = $_SESSION[S3REGISTRATION]->blnGrapeProducer;
					$Args["bMemberID"] = qs($_SESSION[S3REGISTRATION]->bMemberID);

					## SAVE MEMBERSHIP DETAILS
					$dbMember->Fields["refMemberTypeID"] = $_SESSION[S3REGISTRATION]->refMembershipType;
					$dbMember->Fields["strSARSPackhouseNumber"] = $_SESSION[S3REGISTRATION]->strSARSPackhouseNumber;

					## UNSET SESSION VARS
					unset($_SESSION[S3REGISTRATION]->SaveMembership);
				}

				## SAVE TO MEMBER TABLE
				$result = $dbMember->Save(0,0);

				## SET MEMHBER ID IF NOT SET AND SAVE USER TABLE
				if($MemberID == 0)
				{
					$MemberID = $dbMember->ID["MemberID"];

					## UPDATE USER TABLE
					$dbUser->Fields["refMemberID"] = $MemberID;
					$dbUser->Save(0,0);
				}

				## SEPERATE UPDATE FOR ARGUMANTS
				$xdb->doQuery("UPDATE tmpMember SET RegistrationArgs = '". serialize($Args) ."' WHERE MemberID = '$MemberID'",0);


				## GET USER DETAILS
				$UpdatedUserDetails = $xdb->getRowSQL("SELECT * FROM sysUser WHERE UserID = $UserID");

				## UPDATE USER WITH MEMBER ID
				if($UpdatedUserDetails->refMemberID == 0)
				{
					$xdb->doQuery("UPDATE sysUser SET refMemberID =$MemberID WHERE UserID = $UserID");
				}

				## ADD IDS TO SESSION
				$_SESSION[S3REGISTRATION]->UserID = $UserID;
				$_SESSION[S3REGISTRATION]->MemberID = $MemberID;
				break;

			## SAVE DOCUMENTS IN DATABASE
			case "5":

				## LOOP THROUGHT POST FOR UPLOADS AND SAVE EACH
				foreach($_POST[arrID] AS $ID => $Val)
				{
					//CHECK FILE SIZE
					// if($_FILES['arr_strFile']['size'][$ID] > 5500000)
					//    $validFileSize = false;
					// else
					//    $validFileSize = true;

					// //ALLOW CERTAIN FILE FORMATS
					// if($imageFileType != "jpg" && $imageFileType != "png" && $imageFileType != "pdf")
					//    $validFileType = false;
					// else
					//    $validFileType = true;


					$dbDocument = new NemoDatabase("tblDocument", $DocumentID, null, 0);
					if($_FILES["arr_strFile"]["name"][$ID])
					{
						chmod($_FILES["arr_strFile"]["tmp_name"][$ID] , 0777);
						$strFileName = $_SESSION[S3REGISTRATION]->MemberID ."_". $_FILES["arr_strFile"]["name"][$ID];

						$strPath = "./documents/";

						$dbDocument->Fields["EntityType"] = "MemberTMP";
						$dbDocument->Fields["refEntityID"] = $_SESSION[S3REGISTRATION]->MemberID;
						$dbDocument->Fields["strDocumentType"] = $_POST["arr_ddlType"][$ID];
						$dbDocument->Fields["strFilename"] = $_SESSION[S3REGISTRATION]->MemberID ."_".$_FILES["arr_strFile"]["name"][$ID];
						$dbDocument->Fields["dtUploaded"] = date("Y-m-d");
						$dbDocument->Fields["strLastUser"] = "test";

						move_uploaded_file($_FILES['arr_strFile']['tmp_name'][$ID], $strPath . $strFileName);
					}

					## SAVE DOC
					$result = $dbDocument->Save();
				}

				break;

			default:
				# code...
				break;
		}

		## UPDATE REGISTRATION STATUS
		if(isset($MemberID))
		{
			MemberRegistration::UpdateRegistrationStatus($MemberID,$step);			
		}

		return true;
	}

	function UpdateRegistrationStatus($MemberID,$step)
	{
		global $xdb;
		## GET MEMBER DETAILS
		$rowMember = $xdb->getRowSQL("SELECT * FROM tmpMember WHERE MemberID = '$MemberID'");
		$countDocuments = $xdb->getRowSQL("SELECT COUNT(*) AS intCount FROM tblDocument WHERE refEntityID = '$MemberID' AND EntityType = 'MemberTMP'",0)->intCount;

		## GET REGISTRATION STATUS VALUE
		if($rowMember->RegistrationStatus == "")
		{
			$rowMember->RegistrationStatus = "000000";
		}
		## SPLIT REGISTRATION STATUS
		$arrStatus = str_split($rowMember->RegistrationStatus);

		## GET CORRECT POSSITION TO CHANGE
		$idxStep = $step-1;
		switch($step)
		{
			case 1: //user details
			case 2: //user link?
			case 3: //member type
			case 4: //member details
			case 5: //docs
				$arrStatus[0] = 
				$arrStatus[1] = 
				$arrStatus[2] = 
				$arrStatus[3] = 1;
				$arrStatus[$idxStep] = 1;			
				$arrStatus[4] = ($countDocuments>0)? 1:0;
				break;	
		}
		$arrStatus[0] = 1;
		$bitStatus = implode($arrStatus);
		$xdb->doQuery("UPDATE tmpMember SET RegistrationStatus = '$bitStatus' WHERE MemberID = $MemberID",1);
	}

	## GET INFO OR DETAILS FOR EACH FIELD
	function GetTooltip($faqID)
	{
		global $xdb, $arrSys, $TR, $SP, $HR, $DATABASE_SETTINGS, $SystemSettings;

		## GET FAQID DETAILS FROM CORRECT LANGUAGE VIEW
		$faqDetails = $xdb->getRowSQL("SELECT * FROM vieFAQ_".$_SESSION[LANGUAGE]." WHERE FAQID = $faqID");

		## TOOTIP RETURN
		return $faqDetails->txtFAQ;
	}

}
?>